/** Cooked with Flambe, https://getflambe.com */
'use strict';(function(){function m(a,b){function c(){}c.prototype=a;var d=new c,f;for(f in b)d[f]=b[f];b.toString!==Object.prototype.toString&&(d.toString=b.toString);return d}function jc(a){return a instanceof Array?function(){return t.iter(a)}:"function"==typeof a.iterator?ma(a,a.iterator):a.iterator}function ma(a,b){if(null==b)return null;null==b.__id__&&(b.__id__=oc++);var c;null==a.hx__closures__?a.hx__closures__={}:c=a.hx__closures__[b.__id__];null==c&&(c=function(){return c.method.apply(c.scope,
arguments)},c.scope=a,c.method=b,a.hx__closures__[b.__id__]=c);return c}var e={},n=function(){return A.__string_rec(this,"")},K=function(a,b){b=b.split("u").join("");this.r=RegExp(a,b)};e.EReg=K;K.__name__=!0;K.prototype={match:function(a){this.r.global&&(this.r.lastIndex=0);this.r.m=this.r.exec(a);this.r.s=a;return null!=this.r.m},matched:function(a){if(null!=this.r.m&&0<=a&&a<this.r.m.length)return this.r.m[a];throw"EReg::matched";},matchedPos:function(){if(null==this.r.m)throw"No string matched";
return{pos:this.r.m.index,len:this.r.m[0].length}},split:function(a){return a.replace(this.r,"#__delim__#").split("#__delim__#")},__class__:K};var t=function(){};e.HxOverrides=t;t.__name__=!0;t.cca=function(a,b){var c=a.charCodeAt(b);return c!=c?void 0:c};t.substr=function(a,b,c){if(null!=b&&0!=b&&null!=c&&0>c)return"";null==c&&(c=a.length);0>b?(b=a.length+b,0>b&&(b=0)):0>c&&(c=a.length+c-b);return a.substr(b,c)};t.remove=function(a,b){var c=a.indexOf(b);if(-1==c)return!1;a.splice(c,1);return!0};
t.iter=function(a){return{cur:0,arr:a,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var Pa=function(){};e.Lambda=Pa;Pa.__name__=!0;Pa.array=function(a){for(var b=[],a=jc(a)();a.hasNext();){var c=a.next();b.push(c)}return b};Pa.count=function(a,b){var c=0;if(null==b)for(var d=jc(a)();d.hasNext();)d.next(),c++;else for(d=jc(a)();d.hasNext();){var f=d.next();b(f)&&c++}return c};var Xb=function(){};e.IMap=Xb;Xb.__name__=!0;Math.__name__=!0;var wa=function(){};
e.Reflect=wa;wa.__name__=!0;wa.field=function(a,b){try{return a[b]}catch(c){return null}};var F=function(){};e.Std=F;F.__name__=!0;F.is=function(a,b){return A.__instanceof(a,b)};F.instance=function(a,b){return a instanceof b?a:null};F.string=function(a){return A.__string_rec(a,"")};F["int"]=function(a){return a|0};F.parseInt=function(a){var b=parseInt(a,10);if(0==b&&(120==t.cca(a,1)||88==t.cca(a,1)))b=parseInt(a);return isNaN(b)?null:b};var O=function(){};e.StringTools=O;O.__name__=!0;O.startsWith=
function(a,b){return a.length>=b.length&&t.substr(a,0,b.length)==b};O.replace=function(a,b,c){return a.split(b).join(c)};var na=function(){};e.Type=na;na.__name__=!0;na.getClass=function(a){return null==a?null:a instanceof Array&&null==a.__enum__?Array:a.__class__};na.resolveClass=function(a){a=e[a];return null==a||!a.__name__?null:a};na.resolveEnum=function(a){a=e[a];return null==a||!a.__ename__?null:a};na.createEmptyInstance=function(a){function b(){}b.prototype=a.prototype;return new b};var T=
function(){};e["flambe.util.Disposable"]=T;T.__name__=!0;T.prototype={__class__:T};var p=function(){this._flags=0;this.owner=this.next=null};e["flambe.Component"]=p;p.__name__=!0;p.__interfaces__=[T];p.prototype={onAdded:function(){},onRemoved:function(){},onStart:function(){},onStop:function(){},onUpdate:function(){},dispose:function(){null!=this.owner&&this.owner.remove(this)},get_name:function(){return null},__class__:p};var l=function(){this.parent=this.firstChild=this.next=this.firstComponent=
null;this._compMap={}};e["flambe.Entity"]=l;l.__name__=!0;l.__interfaces__=[T];l.prototype={add:function(a){null!=a.owner&&a.owner.remove(a);var b=a.get_name(),c=this._compMap[b];null!=c&&this.remove(c);this._compMap[b]=a;b=null;for(c=this.firstComponent;null!=c;)b=c,c=c.next;null!=b?b.next=a:this.firstComponent=a;a.owner=this;a.next=null;a.onAdded();return this},remove:function(a){for(var b=null,c=this.firstComponent;null!=c;){var d=c.next;if(c==a)return null==b?this.firstComponent=d:(b.owner=this,
b.next=d),delete this._compMap[c.get_name()],0!=(c._flags&1)&&(c.onStop(),c._flags&=-2),c.onRemoved(),c.owner=null,c.next=null,!0;b=c;c=d}return!1},addChild:function(a,b){null==b&&(b=!0);null!=a.parent&&a.parent.removeChild(a);a.parent=this;if(b){for(var c=null,d=this.firstChild;null!=d;)c=d,d=d.next;null!=c?c.next=a:this.firstChild=a}else a.next=this.firstChild,this.firstChild=a;return this},removeChild:function(a){for(var b=null,c=this.firstChild;null!=c;){var d=c.next;if(c==a){null==b?this.firstChild=
d:b.next=d;c.parent=null;c.next=null;break}b=c;c=d}},disposeChildren:function(){for(;null!=this.firstChild;)this.firstChild.dispose()},dispose:function(){for(null!=this.parent&&this.parent.removeChild(this);null!=this.firstComponent;)this.firstComponent.dispose();this.disposeChildren()},__class__:l};var Yb=function(){};e["flambe.util.PackageLog"]=Yb;Yb.__name__=!0;var zb=function(){};e["flambe.platform.Platform"]=zb;zb.__name__=!0;zb.prototype={__class__:zb};var Y=function(){};e["flambe.platform.html.HtmlPlatform"]=
Y;Y.__name__=!0;Y.__interfaces__=[zb];Y.prototype={init:function(){var a=this;k.fixAndroidMath();var b=null;try{b=window.flambe.canvas}catch(c){}b.setAttribute("tabindex","0");b.style.outlineStyle="none";b.style.webkitTapHighlightColor="transparent";b.setAttribute("moz-opaque","true");this._stage=new oa(b);this._pointer=new B;this._mouse=new Qa(this._pointer,b);this._renderer=this.createRenderer(b);this.mainLoop=new pa;this.musicPlaying=!1;this._canvas=b;this._container=b.parentElement;this._container.style.overflow=
"hidden";this._container.style.position="relative";this._container.style.msTouchAction="none";var d=0,f=function(c){if(!(1E3>c.timeStamp-d)){var f=b.getBoundingClientRect(),g=a.getX(c,f),f=a.getY(c,f);switch(c.type){case "mousedown":c.target==b&&(c.preventDefault(),a._mouse.submitDown(g,f,c.button),b.focus());break;case "mousemove":a._mouse.submitMove(g,f);break;case "mouseup":a._mouse.submitUp(g,f,c.button);break;case "mousewheel":case "DOMMouseScroll":a._mouse.submitScroll(g,f,"mousewheel"==c.type?
c.wheelDelta/40:-c.detail)&&c.preventDefault()}}};window.addEventListener("mousedown",f,!1);window.addEventListener("mousemove",f,!1);window.addEventListener("mouseup",f,!1);b.addEventListener("mousewheel",f,!1);b.addEventListener("DOMMouseScroll",f,!1);b.addEventListener("contextmenu",function(a){a.preventDefault()},!1);var g="undefined"!=typeof window.ontouchstart,f="msMaxTouchPoints"in window.navigator&&1<window.navigator.msMaxTouchPoints;if(g||f){var e=new Ra(this._pointer,g?4:window.navigator.msMaxTouchPoints);
this._touch=e;f=function(b){var c;c=g?b.changedTouches:[b];var f=b.target.getBoundingClientRect();d=b.timeStamp;switch(b.type){case "touchstart":case "MSPointerDown":case "pointerdown":b.preventDefault();k.SHOULD_HIDE_MOBILE_BROWSER&&k.hideMobileBrowser();for(b=0;b<c.length;){var o=c[b];++b;var h=a.getX(o,f),i=a.getY(o,f);e.submitDown((g?o.identifier:o.pointerId)|0,h,i)}break;case "touchmove":case "MSPointerMove":case "pointermove":b.preventDefault();for(b=0;b<c.length;)o=c[b],++b,h=a.getX(o,f),i=
a.getY(o,f),e.submitMove((g?o.identifier:o.pointerId)|0,h,i);break;case "touchend":case "touchcancel":case "MSPointerUp":case "pointerup":for(b=0;b<c.length;)o=c[b],++b,h=a.getX(o,f),i=a.getY(o,f),e.submitUp((g?o.identifier:o.pointerId)|0,h,i)}};g?(b.addEventListener("touchstart",f,!1),b.addEventListener("touchmove",f,!1),b.addEventListener("touchend",f,!1),b.addEventListener("touchcancel",f,!1)):(b.addEventListener("MSPointerDown",f,!1),b.addEventListener("MSPointerMove",f,!1),b.addEventListener("MSPointerUp",
f,!1))}else this._touch=new Sa;var o=window.onerror;window.onerror=function(a,b,c){i.uncaughtError.emit(a);return null!=o?o(a,b,c):!1};var h=k.loadExtension("hidden",window.document);null!=h.value?(f=function(){i.hidden.set__(wa.field(window.document,h.field))},f(null),window.document.addEventListener(h.prefix+"visibilitychange",f,!1)):(f=function(a){i.hidden.set__("pagehide"==a.type)},window.addEventListener("pageshow",f,!1),window.addEventListener("pagehide",f,!1));i.hidden.get_changed().connect(function(b){b||
(a._skipFrame=!0)});this._skipFrame=!1;this._lastUpdate=Date.now();var j=k.loadExtension("requestAnimationFrame").value;if(null!=j){var l=window.performance,n=null!=l&&k.polyfill("now",l);n?this._lastUpdate=l.now():null;var m=null,m=function(c){a.update(n?l.now():c);j(m,b)};j(m,b)}else window.setInterval(function(){a.update(Date.now())},16);xa.info("Initialized HTML platform",["renderer",this._renderer.get_type()])},loadAssetPack:function(a){return(new q(this,a)).promise},getStage:function(){return this._stage},
getLocale:function(){var a=window.navigator.language;null==a&&(a=window.navigator.userLanguage);return a},update:function(a){var b=(a-this._lastUpdate)/1E3;this._lastUpdate=a;i.hidden._value||(this._skipFrame?this._skipFrame=!1:(this.mainLoop.update(b),this.mainLoop.render(this._renderer)))},getPointer:function(){return this._pointer},getTouch:function(){return this._touch},getWeb:function(){null==this._web&&(this._web=new Ta(this._container));return this._web},getRenderer:function(){return this._renderer},
getX:function(a,b){return(a.clientX-b.left)*this._stage.get_width()/b.width},getY:function(a,b){return(a.clientY-b.top)*this._stage.get_height()/b.height},createRenderer:function(a){try{var b=Zb.getContextWebGL(a,{alpha:!1,depth:!1,failIfMajorPerformanceCaveat:!0});if(null!=b)if(k.detectSlowDriver(b))null;else return new Ua(this._stage,b)}catch(c){}return new qa(a)},__class__:Y};var C=function(a,b){this._value=a;this._changed=null!=b?new ya(b):null};e["flambe.util.Value"]=C;C.__name__=!0;C.prototype=
{watch:function(a){a(this._value,this._value);return this.get_changed().connect(a)},set__:function(a){var b=this._value;a!=b&&(this._value=a,null!=this._changed&&this._changed.emit(a,b));return a},get_changed:function(){null==this._changed&&(this._changed=new ya);return this._changed},__class__:C};var ra=function(a,b){this._next=null;this._signal=a;this._listener=b;this.stayInList=!0};e["flambe.util.SignalConnection"]=ra;ra.__name__=!0;ra.__interfaces__=[T];ra.prototype={once:function(){this.stayInList=
!1;return this},dispose:function(){null!=this._signal&&(this._signal.disconnect(this),this._signal=null)},__class__:ra};var w=function(a){this._head=null!=a?new ra(this,a):null;this._deferredTasks=null};e["flambe.util.SignalBase"]=w;w.__name__=!0;w.prototype={connectImpl:function(a,b){var c=this,d=new ra(this,a);this._head==w.DISPATCHING_SENTINEL?this.defer(function(){c.listAdd(d,b)}):this.listAdd(d,b);return d},disconnect:function(a){var b=this;this._head==w.DISPATCHING_SENTINEL?this.defer(function(){b.listRemove(a)}):
this.listRemove(a)},defer:function(a){for(var b=null,c=this._deferredTasks;null!=c;)b=c,c=c.next;a=new Ab(a);null!=b?b.next=a:this._deferredTasks=a},willEmit:function(){var a=this._head;this._head=w.DISPATCHING_SENTINEL;return a},didEmit:function(a){this._head=a;a=this._deferredTasks;for(this._deferredTasks=null;null!=a;)a.fn(),a=a.next},listAdd:function(a,b){if(b)a._next=this._head,this._head=a;else{for(var c=null,d=this._head;null!=d;)c=d,d=d._next;null!=c?c._next=a:this._head=a}},listRemove:function(a){for(var b=
null,c=this._head;null!=c;){if(c==a){a=c._next;null==b?this._head=a:b._next=a;break}b=c;c=c._next}},__class__:w};var ya=function(a){w.call(this,a)};e["flambe.util.Signal2"]=ya;ya.__name__=!0;ya.__super__=w;ya.prototype=m(w.prototype,{connect:function(a,b){null==b&&(b=!1);return this.connectImpl(a,b)},emit:function(a,b){var c=this;this._head==w.DISPATCHING_SENTINEL?this.defer(function(){c.emitImpl(a,b)}):this.emitImpl(a,b)},emitImpl:function(a,b){for(var c=this.willEmit(),d=c;null!=d;)d._listener(a,
b),d.stayInList||d.dispose(),d=d._next;this.didEmit(c)},__class__:ya});var v=function(a){w.call(this,a)};e["flambe.util.Signal1"]=v;v.__name__=!0;v.__super__=w;v.prototype=m(w.prototype,{connect:function(a,b){null==b&&(b=!1);return this.connectImpl(a,b)},emit:function(a){var b=this;this._head==w.DISPATCHING_SENTINEL?this.defer(function(){b.emitImpl(a)}):this.emitImpl(a)},emitImpl:function(a){for(var b=this.willEmit(),c=b;null!=c;)c._listener(a),c.stayInList||c.dispose(),c=c._next;this.didEmit(b)},
__class__:v});var s=function(a,b){this._behavior=null;C.call(this,a,b)};e["flambe.animation.AnimatedFloat"]=s;s.__name__=!0;s.__super__=C;s.prototype=m(C.prototype,{set__:function(a){this._behavior=null;return C.prototype.set__.call(this,a)},update:function(a){null!=this._behavior&&(C.prototype.set__.call(this,this._behavior.update(a)),this._behavior.isComplete()&&(this._behavior=null))},animate:function(a,b,c,d){this.set__(a);this.animateTo(b,c,d)},animateTo:function(a,b,c){this.set_behavior(new za(this._value,
a,b,c))},set_behavior:function(a){this._behavior=a;this.update(0);return a},__class__:s});var i=function(){};e["flambe.System"]=i;i.__name__=!0;i.init=function(){i._calledInit||(i._platform.init(),i._calledInit=!0)};i.loadAssetPack=function(a){return i._platform.loadAssetPack(a)};var xa=function(){};e["flambe.Log"]=xa;xa.__name__=!0;xa.info=function(){null};xa.__super__=Yb;xa.prototype=m(Yb.prototype,{__class__:xa});var Va=function(a){null==a&&(a=1);this._realDt=0;p.call(this);this.scale=new s(a)};
e["flambe.SpeedAdjuster"]=Va;Va.__name__=!0;Va.__super__=p;Va.prototype=m(p.prototype,{get_name:function(){return"SpeedAdjuster_2"},onUpdate:function(a){0<this._realDt&&(a=this._realDt,this._realDt=0);this.scale.update(a)},__class__:Va});var Bb=function(){};e["flambe.animation.Behavior"]=Bb;Bb.__name__=!0;Bb.prototype={__class__:Bb};var P=function(){};e["flambe.animation.Ease"]=P;P.__name__=!0;P.linear=function(a){return a};P.quadOut=function(a){return a*(2-a)};P.backOut=function(a){return 1- --a*
a*(-2.70158*a-1.70158)};var za=function(a,b,c,d){this._from=a;this._to=b;this._duration=c;this.elapsed=0;this._easing=null!=d?d:P.linear};e["flambe.animation.Tween"]=za;za.__name__=!0;za.__interfaces__=[Bb];za.prototype={update:function(a){this.elapsed+=a;return this.elapsed>=this._duration?this._to:this._from+(this._to-this._from)*this._easing(this.elapsed/this._duration)},isComplete:function(){return this.elapsed>=this._duration},__class__:za};var aa=function(){};e["flambe.asset.Asset"]=aa;aa.__name__=
!0;aa.__interfaces__=[T];aa.prototype={__class__:aa};var h=e["flambe.asset.AssetFormat"]={__ename__:!0,__constructs__:"WEBP,JXR,PNG,JPG,GIF,DDS,PVR,PKM,MP3,M4A,OPUS,OGG,WAV,Data".split(",")};h.WEBP=["WEBP",0];h.WEBP.toString=n;h.WEBP.__enum__=h;h.JXR=["JXR",1];h.JXR.toString=n;h.JXR.__enum__=h;h.PNG=["PNG",2];h.PNG.toString=n;h.PNG.__enum__=h;h.JPG=["JPG",3];h.JPG.toString=n;h.JPG.__enum__=h;h.GIF=["GIF",4];h.GIF.toString=n;h.GIF.__enum__=h;h.DDS=["DDS",5];h.DDS.toString=n;h.DDS.__enum__=h;h.PVR=
["PVR",6];h.PVR.toString=n;h.PVR.__enum__=h;h.PKM=["PKM",7];h.PKM.toString=n;h.PKM.__enum__=h;h.MP3=["MP3",8];h.MP3.toString=n;h.MP3.__enum__=h;h.M4A=["M4A",9];h.M4A.toString=n;h.M4A.__enum__=h;h.OPUS=["OPUS",10];h.OPUS.toString=n;h.OPUS.__enum__=h;h.OGG=["OGG",11];h.OGG.toString=n;h.OGG.__enum__=h;h.WAV=["WAV",12];h.WAV.toString=n;h.WAV.__enum__=h;h.Data=["Data",13];h.Data.toString=n;h.Data.__enum__=h;var Cb=function(a,b,c,d){this.name=a;this.url=b;this.format=c;this.bytes=d};e["flambe.asset.AssetEntry"]=
Cb;Cb.__name__=!0;Cb.prototype={__class__:Cb};var Wa=function(){};e["flambe.asset.AssetPack"]=Wa;Wa.__name__=!0;Wa.__interfaces__=[T];Wa.prototype={__class__:Wa};var Xa=function(){};e["flambe.asset.File"]=Xa;Xa.__name__=!0;Xa.__interfaces__=[aa];Xa.prototype={__class__:Xa};var y=function(){this._localBase=this._remoteBase=null;this._entries=[]};e["flambe.asset.Manifest"]=y;y.__name__=!0;y.fromAssets=function(a,b){null==b&&(b=!0);var c=wa.field($b.getType(y).assets[0],a);if(null==c){if(b)throw x.withFields("Missing asset pack",
["name",a]);return null}var d=new y;d.set_localBase("assets");for(var f=0;f<c.length;){var g=c[f];++f;var e=g.name,o=a+"/"+e+"?v="+F.string(g.md5),i=y.inferFormat(e);i!=h.Data&&(e=x.removeFileExtension(e));d.add(e,o,g.bytes,i)}return d};y.fromAssetsLocalized=function(a,b,c){null==c&&(c=!0);null==b&&(b=i._platform.getLocale());if(null!=b)for(b=b.split("-");0<b.length;){var d=y.fromAssets(a+"_"+b.join("-"),!1);if(null!=d)return d;b.pop()}return y.fromAssets(a,c)};y.inferFormat=function(a){a=x.getUrlExtension(a);
if(null!=a)switch(a.toLowerCase()){case "gif":return h.GIF;case "jpg":case "jpeg":return h.JPG;case "jxr":case "wdp":return h.JXR;case "png":return h.PNG;case "webp":return h.WEBP;case "dds":return h.DDS;case "pvr":return h.PVR;case "pkm":return h.PKM;case "m4a":return h.M4A;case "mp3":return h.MP3;case "ogg":return h.OGG;case "opus":return h.OPUS;case "wav":return h.WAV}else null;return h.Data};y.prototype={add:function(a,b,c,d){null==c&&(c=0);null==d&&(d=y.inferFormat(b));a=new Cb(a,b,d,c);this._entries.push(a);
return a},iterator:function(){return t.iter(this._entries)},getFullURL:function(a){var b;b=null!=this.get_remoteBase()&&y._supportsCrossOrigin?this.get_remoteBase():this.get_localBase();return null!=b?x.joinPath(b,a.url):a.url},get_localBase:function(){return this._localBase},set_localBase:function(a){null!=a&&ac.that(!O.startsWith(a,"http://")&&!O.startsWith(a,"https://"),"localBase must be a path on the same domain, NOT starting with http(s)://",null);return this._localBase=a},get_remoteBase:function(){return this._remoteBase},
__class__:y};var u=e["flambe.display.BlendMode"]={__ename__:!0,__constructs__:"Normal,Add,Multiply,Screen,Mask,Copy".split(",")};u.Normal=["Normal",0];u.Normal.toString=n;u.Normal.__enum__=u;u.Add=["Add",1];u.Add.toString=n;u.Add.__enum__=u;u.Multiply=["Multiply",2];u.Multiply.toString=n;u.Multiply.__enum__=u;u.Screen=["Screen",3];u.Screen.toString=n;u.Screen.__enum__=u;u.Mask=["Mask",4];u.Mask.toString=n;u.Mask.__enum__=u;u.Copy=["Copy",5];u.Copy.toString=n;u.Copy.__enum__=u;var Ya=function(a,b){null==
b&&(b=0);null==a&&(a=0);this.x=a;this.y=b};e["flambe.math.Point"]=Ya;Ya.__name__=!0;Ya.prototype={__class__:Ya};var j=function(){this.blendMode=this.scissor=null;var a=this;p.call(this);this._flags|=54;this._localMatrix=new Q;var b=function(){a._flags|=24};this.x=new s(0,b);this.y=new s(0,b);this.rotation=new s(0,b);this.scaleX=new s(1,b);this.scaleY=new s(1,b);this.anchorX=new s(0,b);this.anchorY=new s(0,b);this.alpha=new s(1)};e["flambe.display.Sprite"]=j;j.__name__=!0;j.hitTest=function(a,b,c){var d=
a._compMap.Sprite_0;if(null!=d){if(6!=(d._flags&6))return null;d.getLocalMatrix().inverseTransform(b,c,j._scratchPoint)&&(b=j._scratchPoint.x,c=j._scratchPoint.y);var f=d.scissor;if(null!=f&&!f.contains(b,c))return null}a=j.hitTestBackwards(a.firstChild,b,c);return null!=a?a:null!=d&&d.containsLocal(b,c)?d:null};j.getBounds=function(a,b){null==b&&(b=new sa);b.set(1.79769313486231E308,1.79769313486231E308,-1.79769313486231E308,-1.79769313486231E308);j.getBoundsImpl(a,null,b);b.width-=b.x;b.height-=
b.y;return b};j.render=function(a,b){var c=a._compMap.Sprite_0;if(null!=c){var d=c.alpha._value;if(0==(c._flags&2)||0>=d)return;b.save();1>d&&b.multiplyAlpha(d);null!=c.blendMode&&b.setBlendMode(c.blendMode);var d=c.getLocalMatrix(),f=d.m02,g=d.m12;0!=(c._flags&32)&&(f=Math.round(f),g=Math.round(g));b.transform(d.m00,d.m10,d.m01,d.m11,f,g);d=c.scissor;null!=d&&b.applyScissor(d.x,d.y,d.width,d.height);c.draw(b)}d=a._compMap.Director_1;if(null!=d){d=d.occludedScenes;for(f=0;f<d.length;)g=d[f],++f,j.render(g,
b)}for(d=a.firstChild;null!=d;)f=d.next,j.render(d,b),d=f;null!=c&&b.restore()};j.hitTestBackwards=function(a,b,c){if(null!=a){var d=j.hitTestBackwards(a.next,b,c);return null!=d?d:j.hitTest(a,b,c)}return null};j.getBoundsImpl=function(a,b,c){var d=a._compMap.Sprite_0;if(null!=d){var b=null!=b?Q.multiply(b,d.getLocalMatrix()):d.getLocalMatrix(),f=d.getNaturalWidth(),d=d.getNaturalHeight();0<f&&0<d&&(j.extendRect(b,0,0,c),j.extendRect(b,f,0,c),j.extendRect(b,f,d,c),j.extendRect(b,0,d,c))}f=a._compMap.Director_1;
if(null!=f)for(var f=f.occludedScenes,d=0,g=f.length;d<g;)j.getBoundsImpl(f[d],b,c),++d;for(a=a.firstChild;null!=a;)f=a.next,j.getBoundsImpl(a,b,c),a=f};j.extendRect=function(a,b,c,d){a=a.transform(b,c,j._scratchPoint);b=a.x;c=a.y;b<d.x&&(d.x=b);c<d.y&&(d.y=c);b>d.width&&(d.width=b);c>d.height&&(d.height=c)};j.__super__=p;j.prototype=m(p.prototype,{get_name:function(){return"Sprite_0"},getNaturalWidth:function(){return 0},getNaturalHeight:function(){return 0},containsLocal:function(a,b){return 0<=
a&&a<this.getNaturalWidth()&&0<=b&&b<this.getNaturalHeight()},getLocalMatrix:function(){0!=(this._flags&8)&&(this._flags&=-9,this._localMatrix.compose(this.x._value,this.y._value,this.scaleX._value,this.scaleY._value,3.141592653589793*this.rotation._value/180),this._localMatrix.translate(-this.anchorX._value,-this.anchorY._value));return this._localMatrix},setAnchor:function(a,b){this.anchorX.set__(a);this.anchorY.set__(b);return this},centerAnchor:function(){this.anchorX.set__(this.getNaturalWidth()/
2);this.anchorY.set__(this.getNaturalHeight()/2);return this},setXY:function(a,b){this.x.set__(a);this.y.set__(b);return this},setScale:function(a){this.scaleX.set__(a);this.scaleY.set__(a);return this},onAdded:function(){0!=(this._flags&64)&&this.connectHover()},onRemoved:function(){null!=this._hoverConnection&&(this._hoverConnection.dispose(),this._hoverConnection=null)},onUpdate:function(a){this.x.update(a);this.y.update(a);this.rotation.update(a);this.scaleX.update(a);this.scaleY.update(a);this.alpha.update(a);
this.anchorX.update(a);this.anchorY.update(a)},draw:function(){},getParentSprite:function(){if(null==this.owner)return null;for(var a=this.owner.parent;null!=a;){var b=a._compMap.Sprite_0;if(null!=b)return b;a=a.parent}return null},get_pointerDown:function(){null==this._pointerDown&&(this._pointerDown=new v);return this._pointerDown},get_pointerIn:function(){null==this._pointerIn&&(this._pointerIn=new v);return this._pointerIn},connectHover:function(){var a=this;null==this._hoverConnection&&(this._hoverConnection=
i._platform.getPointer().move.connect(function(b){for(var c=b.hit;null!=c;){if(c==a)return;c=c.getParentSprite()}null!=a._pointerOut&&0!=(a._flags&64)&&a._pointerOut.emit(b);a._flags&=-65;a._hoverConnection.dispose();a._hoverConnection=null}))},set_visible:function(a){this._flags=bc.set(this._flags,2,a);return a},onPointerDown:function(a){this.onHover(a);null!=this._pointerDown&&this._pointerDown.emit(a)},onPointerMove:function(a){this.onHover(a);null!=this._pointerMove&&this._pointerMove.emit(a)},
onHover:function(a){if(0==(this._flags&64)&&(this._flags|=64,null!=this._pointerIn||null!=this._pointerOut))null!=this._pointerIn&&this._pointerIn.emit(a),this.connectHover()},onPointerUp:function(a){switch(a.source[1]){case 1:null!=this._pointerOut&&0!=(this._flags&64)&&this._pointerOut.emit(a),this._flags&=-65,null!=this._hoverConnection&&(this._hoverConnection.dispose(),this._hoverConnection=null)}null!=this._pointerUp&&this._pointerUp.emit(a)},__class__:j});var ba=function(a,b,c){j.call(this);
this.color=a;this.width=new s(b);this.height=new s(c)};e["flambe.display.FillSprite"]=ba;ba.__name__=!0;ba.__super__=j;ba.prototype=m(j.prototype,{draw:function(a){a.fillRect(this.color,0,0,this.width._value,this.height._value)},getNaturalWidth:function(){return this.width._value},getNaturalHeight:function(){return this.height._value},onUpdate:function(a){j.prototype.onUpdate.call(this,a);this.width.update(a);this.height.update(a)},__class__:ba});var Za=function(a){this._kernings=null;this.xOffset=
this.yOffset=this.xAdvance=0;this.page=null;this.x=this.y=this.width=this.height=0;this.charCode=a};e["flambe.display.Glyph"]=Za;Za.__name__=!0;Za.prototype={draw:function(a,b,c){0<this.width&&a.drawSubTexture(this.page,b+this.xOffset,c+this.yOffset,this.x,this.y,this.width,this.height)},getKerning:function(a){return null!=this._kernings?F["int"](this._kernings.get(a)):0},setKerning:function(a,b){null==this._kernings&&(this._kernings=new W);this._kernings.set(a,b)},__class__:Za};var ca=function(a,
b){this.name=b;this._pack=a;this._file=a.getFile(b+".fnt");this.reload()};e["flambe.display.Font"]=ca;ca.__name__=!0;ca.prototype={layoutText:function(a,b,c,d,f){null==f&&(f=0);null==d&&(d=0);null==c&&(c=0);null==b&&(b=H.Left);return new da(this,a,b,c,d,f)},reload:function(){this._glyphs=new W;this._glyphs.set(ca.NEWLINE.charCode,ca.NEWLINE);for(var a=new ta(this._file.toString()),b=new W,c=this.name.lastIndexOf("/"),c=0<=c?t.substr(this.name,0,c+1):"",d=a.keywords();d.hasNext();)switch(d.next()){case "info":for(var f=
a.pairs();f.hasNext();){var g=f.next();switch(g.key){case "size":this.size=g.getInt()}}break;case "common":for(f=a.pairs();f.hasNext();)switch(g=f.next(),g.key){case "lineHeight":this.lineHeight=g.getInt()}break;case "page":for(var f=0,g=null,e=a.pairs();e.hasNext();){var o=e.next();switch(o.key){case "id":f=o.getInt();break;case "file":g=o.getString()}}g=this._pack.getTexture(c+x.removeFileExtension(g));b.set(f,g);break;case "char":f=null;for(g=a.pairs();g.hasNext();)switch(e=g.next(),e.key){case "id":f=
new Za(e.getInt());break;case "x":f.x=e.getInt();break;case "y":f.y=e.getInt();break;case "width":f.width=e.getInt();break;case "height":f.height=e.getInt();break;case "page":e=e.getInt();f.page=b.get(e);break;case "xoffset":f.xOffset=e.getInt();break;case "yoffset":f.yOffset=e.getInt();break;case "xadvance":f.xAdvance=e.getInt()}this._glyphs.set(f.charCode,f);break;case "kerning":f=null;e=g=0;for(o=a.pairs();o.hasNext();){var h=o.next();switch(h.key){case "first":f=this._glyphs.get(h.getInt());break;
case "second":g=h.getInt();break;case "amount":e=h.getInt()}}null!=f&&0!=e&&f.setKerning(g,e)}},__class__:ca};var H=e["flambe.display.TextAlign"]={__ename__:!0,__constructs__:["Left","Center","Right"]};H.Left=["Left",0];H.Left.toString=n;H.Left.__enum__=H;H.Center=["Center",1];H.Center.toString=n;H.Center.__enum__=H;H.Right=["Right",2];H.Right.toString=n;H.Right.__enum__=H;var da=function(a,b,c,d,f,g){this.lines=0;var e=this;this._font=a;this._glyphs=[];this._offsets=[];this._lineOffset=Math.round(a.lineHeight+
g);this.bounds=new sa;for(var o=[],g=b.length,h=0;h<g;){var i=h++,i=b.charCodeAt(i),i=a._glyphs.get(i);null!=i?this._glyphs.push(i):null}for(var b=-1,j=0,l=0,a=a._glyphs.get(10),g=function(){e.bounds.width=I.max(e.bounds.width,j);e.bounds.height+=l;o[e.lines]=j;l=j=0;++e.lines},h=0;h<this._glyphs.length;){i=this._glyphs[h];this._offsets[h]=Math.round(j);var k=0<d&&j+i.width>d;k||i==a?(k&&(0<=b?(this._glyphs[b]=a,j=this._offsets[b],h=b):this._glyphs.splice(h,0,a)),b=-1,l=this._lineOffset,g()):(32==
i.charCode&&(b=h),j+=i.xAdvance+f,l=I.max(l,i.height+i.yOffset),h+1<this._glyphs.length&&(j+=i.getKerning(this._glyphs[h+1].charCode)));++h}g();f=0;a=da.getAlignOffset(c,o[0],d);b=1.79769313486231E308;g=-1.79769313486231E308;i=h=0;for(k=this._glyphs.length;i<k;){var n=this._glyphs[i];10==n.charCode&&(f+=this._lineOffset,++h,a=da.getAlignOffset(c,o[h],d));this._offsets[i]+=a;var m=f+n.yOffset;b<m||(b=m);g=I.max(g,m+n.height);++i}this.bounds.x=da.getAlignOffset(c,this.bounds.width,d);this.bounds.y=
b;this.bounds.height=g-b};e["flambe.display.TextLayout"]=da;da.__name__=!0;da.getAlignOffset=function(a,b,c){switch(a[1]){case 0:return 0;case 2:return c-b;case 1:return Math.round((c-b)/2)}};da.prototype={draw:function(a){for(var b=0,c=0,d=this._glyphs.length;c<d;){var f=this._glyphs[c];10==f.charCode?b+=this._lineOffset:f.draw(a,this._offsets[c],b);++c}},__class__:da};var ta=function(a){this._configText=a;this._keywordPattern=new K("([A-Za-z]+)(.*)","");this._pairPattern=new K('([A-Za-z]+)=("[^"]*"|[^\\s]+)',
"")};e["flambe.display._Font.ConfigParser"]=ta;ta.__name__=!0;ta.advance=function(a,b){var c=b.matchedPos();return t.substr(a,c.pos+c.len,a.length)};ta.prototype={keywords:function(){var a=this,b=this._configText;return{next:function(){b=ta.advance(b,a._keywordPattern);a._pairText=a._keywordPattern.matched(2);return a._keywordPattern.matched(1)},hasNext:function(){return a._keywordPattern.match(b)}}},pairs:function(){var a=this,b=this._pairText;return{next:function(){b=ta.advance(b,a._pairPattern);
return new Db(a._pairPattern.matched(1),a._pairPattern.matched(2))},hasNext:function(){return a._pairPattern.match(b)}}},__class__:ta};var Db=function(a,b){this.key=a;this._value=b};e["flambe.display._Font.ConfigPair"]=Db;Db.__name__=!0;Db.prototype={getInt:function(){return F.parseInt(this._value)},getString:function(){return 34!=this._value.charCodeAt(0)?null:t.substr(this._value,1,this._value.length-2)},__class__:Db};var Eb=function(){};e["flambe.display.Graphics"]=Eb;Eb.__name__=!0;Eb.prototype=
{__class__:Eb};var D=function(a){j.call(this);this.texture=a};e["flambe.display.ImageSprite"]=D;D.__name__=!0;D.__super__=j;D.prototype=m(j.prototype,{draw:function(a){null!=this.texture&&a.drawTexture(this.texture,0,0)},getNaturalWidth:function(){return null!=this.texture?this.texture.get_width():0},getNaturalHeight:function(){return null!=this.texture?this.texture.get_height():0},__class__:D});var Z=e["flambe.display.Orientation"]={__ename__:!0,__constructs__:["Portrait","Landscape"]};Z.Portrait=
["Portrait",0];Z.Portrait.toString=n;Z.Portrait.__enum__=Z;Z.Landscape=["Landscape",1];Z.Landscape.toString=n;Z.Landscape.__enum__=Z;var ea=function(a,b,c){null==c&&(c=-1);null==b&&(b=-1);j.call(this);this.texture=a;0>b&&(b=null!=a?a.get_width():0);this.width=new s(b);0>c&&(c=null!=a?a.get_height():0);this.height=new s(c)};e["flambe.display.PatternSprite"]=ea;ea.__name__=!0;ea.__super__=j;ea.prototype=m(j.prototype,{draw:function(a){null!=this.texture&&a.drawPattern(this.texture,0,0,this.width._value,
this.height._value)},getNaturalWidth:function(){return this.width._value},getNaturalHeight:function(){return this.height._value},onUpdate:function(a){j.prototype.onUpdate.call(this,a);this.width.update(a);this.height.update(a)},__class__:ea});var $a=function(){};e["flambe.display.Texture"]=$a;$a.__name__=!0;$a.__interfaces__=[aa];$a.prototype={__class__:$a};var cc=function(){};e["flambe.display.SubTexture"]=cc;cc.__name__=!0;cc.__interfaces__=[$a];var Aa=function(a,b){null==b&&(b="");this._layout=
null;var c=this;j.call(this);this._font=a;this._text=b;this._align=H.Left;this._flags|=128;var d=function(){c._flags|=128};this.wrapWidth=new s(0,d);this.letterSpacing=new s(0,d);this.lineSpacing=new s(0,d)};e["flambe.display.TextSprite"]=Aa;Aa.__name__=!0;Aa.__super__=j;Aa.prototype=m(j.prototype,{draw:function(a){this.updateLayout();this._layout.draw(a)},getNaturalWidth:function(){this.updateLayout();return 0<this.wrapWidth._value?this.wrapWidth._value:this._layout.bounds.width},getNaturalHeight:function(){this.updateLayout();
var a=this._layout.lines*(this._font.lineHeight+this.lineSpacing._value),b=this._layout.bounds.height;return a>b?a:b},containsLocal:function(a,b){this.updateLayout();return this._layout.bounds.contains(a,b)},setWrapWidth:function(a){this.wrapWidth.set__(a);return this},setAlign:function(a){this.set_align(a);return this},set_text:function(a){a!=this._text&&(this._text=a,this._flags|=128);return a},set_align:function(a){a!=this._align&&(this._align=a,this._flags|=128);return a},updateLayout:function(){0!=
(this._flags&128)&&(this._flags&=-129,this._layout=this._font.layoutText(this._text,this._align,this.wrapWidth._value,this.letterSpacing._value,this.lineSpacing._value))},onUpdate:function(a){j.prototype.onUpdate.call(this,a);this.wrapWidth.update(a);this.letterSpacing.update(a);this.lineSpacing.update(a)},__class__:Aa});var E=e["flambe.input.MouseButton"]={__ename__:!0,__constructs__:["Left","Middle","Right","Unknown"]};E.Left=["Left",0];E.Left.toString=n;E.Left.__enum__=E;E.Middle=["Middle",1];
E.Middle.toString=n;E.Middle.__enum__=E;E.Right=["Right",2];E.Right.toString=n;E.Right.__enum__=E;E.Unknown=function(a){a=["Unknown",3,a];a.__enum__=E;a.toString=n;return a};var R=e["flambe.input.MouseCursor"]={__ename__:!0,__constructs__:["Default","Button","None"]};R.Default=["Default",0];R.Default.toString=n;R.Default.__enum__=R;R.Button=["Button",1];R.Button.toString=n;R.Button.__enum__=R;R.None=["None",2];R.None.toString=n;R.None.__enum__=R;var Fb=function(){this.init(0,0,0,null)};e["flambe.input.MouseEvent"]=
Fb;Fb.__name__=!0;Fb.prototype={init:function(a,b,c,d){this.id=a;this.viewX=b;this.viewY=c;this.button=d},__class__:Fb};var ab=e["flambe.input.EventSource"]={__ename__:!0,__constructs__:["Mouse","Touch"]};ab.Mouse=function(a){a=["Mouse",0,a];a.__enum__=ab;a.toString=n;return a};ab.Touch=function(a){a=["Touch",1,a];a.__enum__=ab;a.toString=n;return a};var Gb=function(){this.init(0,0,0,null,null)};e["flambe.input.PointerEvent"]=Gb;Gb.__name__=!0;Gb.prototype={init:function(a,b,c,d,f){this.id=a;this.viewX=
b;this.viewY=c;this.hit=d;this.source=f;this._stopped=!1},__class__:Gb};var Hb=function(a){this.id=a;this._source=ab.Touch(this)};e["flambe.input.TouchPoint"]=Hb;Hb.__name__=!0;Hb.prototype={init:function(a,b){this.viewX=a;this.viewY=b},__class__:Hb};var I=function(){};e["flambe.math.FMath"]=I;I.__name__=!0;I.toDegrees=function(a){return 180*a/3.141592653589793};I.max=function(a,b){return a>b?a:b};I.min=function(a,b){return a<b?a:b};var Q=function(){this.identity()};e["flambe.math.Matrix"]=Q;Q.__name__=
!0;Q.multiply=function(a,b,c){null==c&&(c=new Q);var d=a.m00*b.m00+a.m01*b.m10,f=a.m00*b.m01+a.m01*b.m11,g=a.m00*b.m02+a.m01*b.m12+a.m02;c.m00=d;c.m01=f;c.m02=g;d=a.m10*b.m00+a.m11*b.m10;f=a.m10*b.m01+a.m11*b.m11;g=a.m10*b.m02+a.m11*b.m12+a.m12;c.m10=d;c.m11=f;c.m12=g;return c};Q.prototype={set:function(a,b,c,d,f,g){this.m00=a;this.m01=c;this.m02=f;this.m10=b;this.m11=d;this.m12=g},identity:function(){this.set(1,0,0,1,0,0)},compose:function(a,b,c,d,f){var g=Math.sin(f),f=Math.cos(f);this.set(f*c,
g*c,-g*d,f*d,a,b)},translate:function(a,b){this.m02+=this.m00*a+this.m01*b;this.m12+=this.m11*b+this.m10*a},invert:function(){var a=this.determinant();if(0==a)return!1;this.set(this.m11/a,-this.m01/a,-this.m10/a,this.m00/a,(this.m01*this.m12-this.m11*this.m02)/a,(this.m10*this.m02-this.m00*this.m12)/a);return!0},transform:function(a,b,c){null==c&&(c=new Ya);c.x=a*this.m00+b*this.m01+this.m02;c.y=a*this.m10+b*this.m11+this.m12;return c},transformArray:function(a,b,c){for(var d=0;d<b;){var f=a[d],g=
a[d+1];c[d++]=f*this.m00+g*this.m01+this.m02;c[d++]=f*this.m10+g*this.m11+this.m12}},determinant:function(){return this.m00*this.m11-this.m01*this.m10},inverseTransform:function(a,b,c){var d=this.determinant();if(0==d)return!1;a-=this.m02;b-=this.m12;c.x=(a*this.m11-b*this.m01)/d;c.y=(b*this.m00-a*this.m10)/d;return!0},clone:function(a){null==a&&(a=new Q);a.set(this.m00,this.m10,this.m01,this.m11,this.m02,this.m12);return a},__class__:Q};var sa=function(a,b,c,d){null==d&&(d=0);null==c&&(c=0);null==
b&&(b=0);null==a&&(a=0);this.set(a,b,c,d)};e["flambe.math.Rectangle"]=sa;sa.__name__=!0;sa.prototype={set:function(a,b,c,d){this.x=a;this.y=b;this.width=c;this.height=d},contains:function(a,b){a-=this.x;if(0<=this.width){if(0>a||a>this.width)return!1}else if(0<a||a<this.width)return!1;b-=this.y;if(0<=this.height){if(0>b||b>this.height)return!1}else if(0<b||b<this.height)return!1;return!0},clone:function(a){null==a&&(a=new sa);a.set(this.x,this.y,this.width,this.height);return a},equals:function(a){return this.x==
a.x&&this.y==a.y&&this.width==a.width&&this.height==a.height},__class__:sa};var z=function(){this._disposed=!1};e["flambe.platform.BasicAsset"]=z;z.__name__=!0;z.__interfaces__=[aa];z.prototype={dispose:function(){this._disposed||(this._disposed=!0,this.onDisposed())},onDisposed:function(){null},__class__:z};var fa=function(a,b){var c=this;this.manifest=b;this._platform=a;this.promise=new bb;this._bytesLoaded=new L;this._pack=new cb(b,this);var d=Pa.array(b);if(0==d.length)this.handleSuccess();else{for(var f=
new L,g=0;g<d.length;){var e=d[g];++g;var o=f.get(e.name);null==o&&(o=[],f.set(e.name,o));o.push(e)}this._assetsRemaining=Pa.count(f);for(d=f.iterator();d.hasNext();)f=[d.next()],this.pickBestEntry(f[0],function(a){return function(d){if(null!=d){var f=b.getFullURL(d);try{c.loadEntry(f,d)}catch(g){c.handleError(d,"Unexpected error: "+F.string(g))}f=c.promise;f.set_total(f._total+d.bytes)}else d=a[0][0],fa.isAudio(d.format)?c.handleLoad(d,M.getInstance()):c.handleError(d,"Could not find a supported format to load")}}(f))}};
e["flambe.platform.BasicAssetPackLoader"]=fa;fa.__name__=!0;fa.isAudio=function(a){switch(a[1]){case 8:case 9:case 10:case 11:case 12:return!0;default:return!1}};fa.prototype={onDisposed:function(){},pickBestEntry:function(a,b){this.getAssetFormats(function(c){for(var d=0;d<c.length;){var f=c[d];++d;for(var g=0;g<a.length;){var e=a[g];++g;if(e.format==f){b(e);return}}}b(null)})},loadEntry:function(){null},getAssetFormats:function(){null},handleLoad:function(a,b){if(!this._pack.disposed){this.handleProgress(a,
a.bytes);var c;switch(a.format[1]){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:c=this._pack.textures;break;case 8:case 9:case 10:case 11:case 12:c=this._pack.sounds;break;case 13:c=this._pack.files}c.set(a.name,b);this._assetsRemaining-=1;0==this._assetsRemaining&&this.handleSuccess()}},handleProgress:function(a,b){this._bytesLoaded.set(a.name,b);for(var c=0,d=this._bytesLoaded.iterator();d.hasNext();)var f=d.next(),c=c+f;this.promise.set_progress(c)},handleSuccess:function(){this.promise.set_result(this._pack)},
handleError:function(a,b){this.promise.error.emit(x.withFields(b,["url",a.url]))},handleTextureError:function(a){this.handleError(a,"Failed to create texture. Is the GPU context unavailable?")},__class__:fa};var cb=function(a,b){this.disposed=!1;this._manifest=a;this.loader=b;this.textures=new L;this.sounds=new L;this.files=new L};e["flambe.platform._BasicAssetPackLoader.BasicAssetPack"]=cb;cb.__name__=!0;cb.__interfaces__=[Wa];cb.prototype={getTexture:function(a,b){null==b&&(b=!0);var c=this.textures.get(a);
if(null==c&&b)throw x.withFields("Missing texture",["name",a]);return c},getSound:function(a,b){null==b&&(b=!0);var c=this.sounds.get(a);if(null==c&&b)throw x.withFields("Missing sound",["name",a]);return c},getFile:function(a,b){null==b&&(b=!0);var c=this.files.get(a);if(null==c&&b)throw x.withFields("Missing file",["name",a]);return c},dispose:function(){if(!this.disposed){this.disposed=!0;for(var a=this.textures.iterator();a.hasNext();)a.next().dispose();this.textures=null;for(a=this.sounds.iterator();a.hasNext();)a.next().dispose();
this.sounds=null;for(a=this.files.iterator();a.hasNext();)a.next().dispose();this.files=null;this.loader.onDisposed()}},__class__:cb};var Ba=function(a){this._disposed=!1;this._content=a};e["flambe.platform.BasicFile"]=Ba;Ba.__name__=!0;Ba.__interfaces__=[Xa];Ba.__super__=z;Ba.prototype=m(z.prototype,{toString:function(){return this._content},onDisposed:function(){this._content=null},__class__:Ba});var kc=function(){};e["flambe.subsystem.MouseSystem"]=kc;kc.__name__=!0;var J=function(a){this._pointer=
a;this._source=ab.Mouse(J._sharedEvent);this.down=new v;this.move=new v;this.up=new v;this.scroll=new v;this._y=this._x=0;this._cursor=R.Default;this._buttonStates=new W};e["flambe.platform.BasicMouse"]=J;J.__name__=!0;J.__interfaces__=[kc];J.prototype={submitDown:function(a,b,c){this._buttonStates.exists(c)||(this._buttonStates.set(c,!0),this.prepare(a,b,Ib.toButton(c)),this._pointer.submitDown(a,b,this._source),this.down.emit(J._sharedEvent))},submitMove:function(a,b){this.prepare(a,b,null);this._pointer.submitMove(a,
b,this._source);this.move.emit(J._sharedEvent)},submitUp:function(a,b,c){this._buttonStates.exists(c)&&(this._buttonStates.remove(c),this.prepare(a,b,Ib.toButton(c)),this._pointer.submitUp(a,b,this._source),this.up.emit(J._sharedEvent))},submitScroll:function(a,b,c){this._x=a;this._y=b;if(null==this.scroll._head)return!1;this.scroll.emit(c);return!0},prepare:function(a,b,c){this._x=a;this._y=b;J._sharedEvent.init(J._sharedEvent.id+1,a,b,c)},__class__:J};var Jb=function(){};e["flambe.subsystem.PointerSystem"]=
Jb;Jb.__name__=!0;Jb.prototype={__class__:Jb};var B=function(a,b,c){null==c&&(c=!1);null==b&&(b=0);null==a&&(a=0);this.down=new v;this.move=new v;this.up=new v;this._x=a;this._y=b;this._isDown=c};e["flambe.platform.BasicPointer"]=B;B.__name__=!0;B.__interfaces__=[Jb];B.prototype={get_x:function(){return this._x},get_y:function(){return this._y},submitDown:function(a,b,c){if(!this._isDown){this.submitMove(a,b,c);this._isDown=!0;var d=[],f=j.hitTest(i.root,a,b);if(null!=f){var g=f.owner;do{var e=g._compMap.Sprite_0;
null!=e&&d.push(e);g=g.parent}while(null!=g)}this.prepare(a,b,f,c);for(a=0;a<d.length;)if(b=d[a],++a,b.onPointerDown(B._sharedEvent),B._sharedEvent._stopped)return;this.down.emit(B._sharedEvent)}},submitMove:function(a,b,c){if(!(a==this._x&&b==this._y)){var d=[],f=j.hitTest(i.root,a,b);if(null!=f){var g=f.owner;do{var e=g._compMap.Sprite_0;null!=e&&d.push(e);g=g.parent}while(null!=g)}this.prepare(a,b,f,c);for(a=0;a<d.length;)if(b=d[a],++a,b.onPointerMove(B._sharedEvent),B._sharedEvent._stopped)return;
this.move.emit(B._sharedEvent)}},submitUp:function(a,b,c){if(this._isDown){this.submitMove(a,b,c);this._isDown=!1;var d=[],f=j.hitTest(i.root,a,b);if(null!=f){var g=f.owner;do{var e=g._compMap.Sprite_0;null!=e&&d.push(e);g=g.parent}while(null!=g)}this.prepare(a,b,f,c);for(a=0;a<d.length;)if(b=d[a],++a,b.onPointerUp(B._sharedEvent),B._sharedEvent._stopped)return;this.up.emit(B._sharedEvent)}},prepare:function(a,b,c,d){this._x=a;this._y=b;B._sharedEvent.init(B._sharedEvent.id+1,a,b,c,d)},__class__:B};
var U=function(a,b,c){this._x=this._y=0;this._parent=null;this.rootX=this.rootY=0;this._disposed=!1;this.root=a;this._width=b;this._height=c};e["flambe.platform.BasicTexture"]=U;U.__name__=!0;U.__interfaces__=[cc];U.__super__=z;U.prototype=m(z.prototype,{subTexture:function(a,b,c,d){c=this.root.createTexture(c,d);c._parent=this;c._x=a;c._y=b;c.rootX=this.rootX+a;c.rootY=this.rootY+b;return c},split:function(a,b){null==b&&(b=1);for(var c=[],d=this._width/a|0,f=this._height/b|0,g=0;g<b;)for(var e=g++,
o=0;o<a;){var h=o++;c.push(this.subTexture(h*d,e*f,d,f))}return c},onDisposed:function(){null==this._parent&&this.root.dispose()},get_width:function(){return this._width},get_height:function(){return this._height},__class__:U});var db=function(){};e["flambe.subsystem.TouchSystem"]=db;db.__name__=!0;db.prototype={__class__:db};var Ra=function(a,b){null==b&&(b=4);this._pointer=a;this._maxPoints=b;this._pointMap=new W;this._points=[];this.down=new v;this.move=new v;this.up=new v};e["flambe.platform.BasicTouch"]=
Ra;Ra.__name__=!0;Ra.__interfaces__=[db];Ra.prototype={get_supported:function(){return!0},submitDown:function(a,b,c){if(!this._pointMap.exists(a)){var d=new Hb(a);d.init(b,c);this._pointMap.set(a,d);this._points.push(d);null==this._pointerTouch&&(this._pointerTouch=d,this._pointer.submitDown(b,c,d._source));this.down.emit(d)}},submitMove:function(a,b,c){a=this._pointMap.get(a);null!=a&&(a.init(b,c),this._pointerTouch==a&&this._pointer.submitMove(b,c,a._source),this.move.emit(a))},submitUp:function(a,
b,c){var d=this._pointMap.get(a);null!=d&&(d.init(b,c),this._pointMap.remove(a),t.remove(this._points,d),this._pointerTouch==d&&(this._pointerTouch=null,this._pointer.submitUp(b,c,d._source)),this.up.emit(d))},__class__:Ra};var ua=function(){};e["flambe.sound.Sound"]=ua;ua.__name__=!0;ua.__interfaces__=[aa];ua.prototype={__class__:ua};var M=function(){this._disposed=!1;this._playback=new eb(this)};e["flambe.platform.DummySound"]=M;M.__name__=!0;M.__interfaces__=[ua];M.getInstance=function(){null==
M._instance&&(M._instance=new M);return M._instance};M.__super__=z;M.prototype=m(z.prototype,{play:function(){return this._playback},onDisposed:function(){},__class__:M});var fb=function(){};e["flambe.sound.Playback"]=fb;fb.__name__=!0;fb.__interfaces__=[T];var eb=function(a){this._sound=a;this.volume=new s(0);this._complete=new C(!0)};e["flambe.platform.DummyPlayback"]=eb;eb.__name__=!0;eb.__interfaces__=[fb];eb.prototype={dispose:function(){},__class__:eb};var Sa=function(){this.down=new v;this.move=
new v;this.up=new v};e["flambe.platform.DummyTouch"]=Sa;Sa.__name__=!0;Sa.__interfaces__=[db];Sa.prototype={get_supported:function(){return!1},__class__:Sa};var Ca=function(){this._entries=[]};e["flambe.platform.EventGroup"]=Ca;Ca.__name__=!0;Ca.__interfaces__=[T];Ca.prototype={addListener:function(a,b,c){a.addEventListener(b,c,!1);this._entries.push(new Kb(a,b,c))},addDisposingListener:function(a,b,c){var d=this;this.addListener(a,b,function(a){d.dispose();c(a)})},dispose:function(){for(var a=0,
b=this._entries;a<b.length;){var c=b[a];++a;c.dispatcher.removeEventListener(c.type,c.listener,!1)}this._entries=[]},__class__:Ca};var Kb=function(a,b,c){this.dispatcher=a;this.type=b;this.listener=c};e["flambe.platform._EventGroup.Entry"]=Kb;Kb.__name__=!0;Kb.prototype={__class__:Kb};var Da=function(){};e["flambe.platform.InternalGraphics"]=Da;Da.__name__=!0;Da.__interfaces__=[Eb];Da.prototype={__class__:Da};var Lb=function(){};e["flambe.subsystem.RendererSystem"]=Lb;Lb.__name__=!0;Lb.prototype=
{__class__:Lb};var Ea=function(){};e["flambe.platform.InternalRenderer"]=Ea;Ea.__name__=!0;Ea.__interfaces__=[Lb];Ea.prototype={__class__:Ea};var pa=function(){this._tickables=[]};e["flambe.platform.MainLoop"]=pa;pa.__name__=!0;pa.updateEntity=function(a,b){var c=a._compMap.SpeedAdjuster_2;if(null!=c&&(c._realDt=b,b*=c.scale._value,0>=b)){c.onUpdate(b);return}for(c=a.firstComponent;null!=c;){var d=c.next;0==(c._flags&1)&&(c._flags|=1,c.onStart());c.onUpdate(b);c=d}for(c=a.firstChild;null!=c;)d=c.next,
pa.updateEntity(c,b),c=d};pa.prototype={update:function(a){if(!(0>=a)){1<a&&(a=1);for(var b=0;b<this._tickables.length;){var c=this._tickables[b];null==c||c.update(a)?this._tickables.splice(b,1):++b}i.volume.update(a);pa.updateEntity(i.root,a)}},render:function(a){var b=a.graphics;null!=b&&(a.willRender(),j.render(i.root,b),a.didRender())},addTickable:function(a){this._tickables.push(a)},__class__:pa};var Mb=function(){};e["flambe.platform.MathUtil"]=Mb;Mb.__name__=!0;Mb.nextPowerOfTwo=function(a){for(var b=
1;b<a;)b<<=1;return b};var Ib=function(){};e["flambe.platform.MouseCodes"]=Ib;Ib.__name__=!0;Ib.toButton=function(a){switch(a){case 0:return E.Left;case 1:return E.Middle;case 2:return E.Right}return E.Unknown(a)};var gb=function(){};e["flambe.platform.TextureRoot"]=gb;gb.__name__=!0;gb.prototype={__class__:gb};var hb=function(){};e["flambe.platform.Tickable"]=hb;hb.__name__=!0;hb.prototype={__class__:hb};var ib=function(a,b){this._firstDraw=!1;this._canvasCtx=a.getContext("2d",{alpha:b})};e["flambe.platform.html.CanvasGraphics"]=
ib;ib.__name__=!0;ib.__interfaces__=[Da];ib.prototype={save:function(){this._canvasCtx.save()},transform:function(a,b,c,d,f,g){this._canvasCtx.transform(a,b,c,d,f,g)},restore:function(){this._canvasCtx.restore()},drawTexture:function(a,b,c){this.drawSubTexture(a,b,c,0,0,a.get_width(),a.get_height())},drawSubTexture:function(a,b,c,d,f,g,e){this._firstDraw?(this._firstDraw=!1,this._canvasCtx.globalCompositeOperation="copy",this.drawSubTexture(a,b,c,d,f,g,e),this._canvasCtx.globalCompositeOperation=
"source-over"):this._canvasCtx.drawImage(a.root.image,a.rootX+d|0,a.rootY+f|0,g|0,e|0,b|0,c|0,g|0,e|0)},drawPattern:function(a,b,c,d,f){this._firstDraw?(this._firstDraw=!1,this._canvasCtx.globalCompositeOperation="copy",this.drawPattern(a,b,c,d,f),this._canvasCtx.globalCompositeOperation="source-over"):(this._canvasCtx.fillStyle=a.getPattern(),this._canvasCtx.fillRect(b|0,c|0,d|0,f|0))},fillRect:function(a,b,c,d,f){if(this._firstDraw)this._firstDraw=!1,this._canvasCtx.globalCompositeOperation="copy",
this.fillRect(a,b,c,d,f),this._canvasCtx.globalCompositeOperation="source-over";else{for(a=(16777215&a).toString(16);6>a.length;)a="0"+F.string(a);this._canvasCtx.fillStyle="#"+F.string(a);this._canvasCtx.fillRect(b|0,c|0,d|0,f|0)}},multiplyAlpha:function(a){this._canvasCtx.globalAlpha*=a},setBlendMode:function(a){var b;switch(a[1]){case 0:b="source-over";break;case 1:b="lighter";break;case 2:b="multiply";break;case 3:b="screen";break;case 4:b="destination-in";break;case 5:b="copy"}this._canvasCtx.globalCompositeOperation=
b},applyScissor:function(a,b,c,d){this._canvasCtx.beginPath();this._canvasCtx.rect(a|0,b|0,c|0,d|0);this._canvasCtx.clip()},willRender:function(){this._firstDraw=!0},didRender:function(){},onResize:function(){},__class__:ib};var qa=function(a){this.graphics=new ib(a,!1);this._hasGPU=new C(!0)};e["flambe.platform.html.CanvasRenderer"]=qa;qa.__name__=!0;qa.__interfaces__=[Ea];qa.prototype={get_type:function(){return N.Canvas},createTextureFromImage:function(a){a=new Fa(qa.CANVAS_TEXTURES?k.createCanvas(a):
a);return a.createTexture(a.width,a.height)},getCompressedTextureFormats:function(){return[]},createCompressedTexture:function(){return null},willRender:function(){this.graphics.willRender()},didRender:function(){this.graphics.didRender()},__class__:qa};var jb=function(a,b,c){this._rootUpdateCount=0;this._pattern=null;U.call(this,a,b,c)};e["flambe.platform.html.CanvasTexture"]=jb;jb.__name__=!0;jb.__super__=U;jb.prototype=m(U.prototype,{getPattern:function(){if(this._rootUpdateCount!=this.root.updateCount||
null==this._pattern)this._rootUpdateCount=this.root.updateCount,this._pattern=this.root.createPattern(this.rootX,this.rootY,this._width,this._height);return this._pattern},__class__:jb});var Fa=function(a){this._graphics=null;this.updateCount=0;this._disposed=!1;this.image=a;this.width=a.width;this.height=a.height};e["flambe.platform.html.CanvasTextureRoot"]=Fa;Fa.__name__=!0;Fa.__interfaces__=[gb];Fa.__super__=z;Fa.prototype=m(z.prototype,{createTexture:function(a,b){return new jb(this,a,b)},createPattern:function(a,
b,c,d){var f=this.getContext2d(),g=this.image;if(0!=a||0!=b||c!=this.width||d!=this.height)g=k.createEmptyCanvas(c,d),c=g.getContext("2d"),c.globalCompositeOperation="copy",c.drawImage(this.image,-a,-b);return f.createPattern(g,"repeat")},getContext2d:function(){A.__instanceof(this.image,HTMLCanvasElement)||(this.image=k.createCanvas(this.image));return this.image.getContext("2d")},onDisposed:function(){this._graphics=this.image=null},__class__:Fa});var q=function(a,b){fa.call(this,a,b)};e["flambe.platform.html.HtmlAssetPackLoader"]=
q;q.__name__=!0;q.detectImageFormats=function(a){var b=[h.PNG,h.JPG,h.GIF],c=2,d;d=window.document.createElement("img");d.onload=d.onerror=function(){1==d.width&&b.unshift(h.WEBP);--c;0==c&&a(b)};d.src="data:image/webp;base64,UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==";var f;f=window.document.createElement("img");f.onload=f.onerror=function(){1==f.width&&b.unshift(h.JXR);--c;0==c&&a(b)};f.src="data:image/vnd.ms-photo;base64,SUm8AQgAAAAFAAG8AQAQAAAASgAAAIC8BAABAAAAAQAAAIG8BAABAAAAAQAAAMC8BAABAAAAWgAAAMG8BAABAAAAHwAAAAAAAAAkw91vA07+S7GFPXd2jckNV01QSE9UTwAZAYBxAAAAABP/gAAEb/8AAQAAAQAAAA=="};
q.detectAudioFormats=function(){var a;a=window.document.createElement("audio");if(null==a||null==ma(a,a.canPlayType))return[];var b=new K("\\b(iPhone|iPod|iPad|Android|Windows Phone)\\b",""),c=window.navigator.userAgent;if(!r.get_supported()&&b.match(c))return[];for(var b=[{format:h.M4A,mimeType:"audio/mp4; codecs=mp4a"},{format:h.MP3,mimeType:"audio/mpeg"},{format:h.OPUS,mimeType:"audio/ogg; codecs=opus"},{format:h.OGG,mimeType:"audio/ogg; codecs=vorbis"},{format:h.WAV,mimeType:"audio/wav"}],c=[],
d=0;d<b.length;){var f=b[d];++d;var g="";try{g=a.canPlayType(f.mimeType)}catch(e){}""!=g&&c.push(f.format)}return c};q.supportsBlob=function(){if(q._detectBlobSupport){q._detectBlobSupport=!1;if((new K("\\bSilk\\b","")).match(window.navigator.userAgent)||null==window.Blob)return!1;var a=new XMLHttpRequest;a.open("GET",".",!0);if(""!=a.responseType)return!1;a.responseType="blob";if("blob"!=a.responseType)return!1;q._URL=k.loadExtension("URL").value}return null!=q._URL&&null!=q._URL.createObjectURL};
q.__super__=fa;q.prototype=m(fa.prototype,{loadEntry:function(a,b){var c=this;switch(b.format[1]){case 0:case 1:case 2:case 3:case 4:var d;d=window.document.createElement("img");var f=new Ca;f.addDisposingListener(d,"load",function(){q.supportsBlob()&&q._URL.revokeObjectURL(d.src);var a=c._platform.getRenderer().createTextureFromImage(d);null!=a?c.handleLoad(b,a):c.handleTextureError(b)});f.addDisposingListener(d,"error",function(){c.handleError(b,"Failed to load image")});q.supportsBlob()?this.download(a,
b,"blob",function(a){d.src=q._URL.createObjectURL(a)}):d.src=a;break;case 5:case 6:case 7:this.download(a,b,"arraybuffer",function(){var a=c._platform.getRenderer().createCompressedTexture(b.format,null);null!=a?c.handleLoad(b,a):c.handleTextureError(b)});break;case 8:case 9:case 10:case 11:case 12:if(r.get_supported())this.download(a,b,"arraybuffer",function(a){r.ctx.decodeAudioData(a,function(a){c.handleLoad(b,new r(a))},function(){c.handleLoad(b,M.getInstance())})});else{var g;g=window.document.createElement("audio");
g.preload="auto";var e=++q._mediaRefCount;null==q._mediaElements&&(q._mediaElements=new W);q._mediaElements.set(e,g);f=new Ca;f.addDisposingListener(g,"canplaythrough",function(){q._mediaElements.remove(e);c.handleLoad(b,new Ga(g))});f.addDisposingListener(g,"error",function(){q._mediaElements.remove(e);var a=g.error.code;3==a||4==a?c.handleLoad(b,M.getInstance()):c.handleError(b,"Failed to load audio: "+g.error.code)});f.addListener(g,"progress",function(){if(0<g.buffered.length&&0<g.duration){var a=
g.buffered.end(0)/g.duration;c.handleProgress(b,a*b.bytes|0)}});g.src=a;g.load()}break;case 13:this.download(a,b,"text",function(a){c.handleLoad(b,new Ba(a))})}},getAssetFormats:function(a){var b=this;null==q._supportedFormats&&(q._supportedFormats=new bb,q.detectImageFormats(function(a){q._supportedFormats.set_result(b._platform.getRenderer().getCompressedTextureFormats().concat(a).concat(q.detectAudioFormats()).concat([h.Data]))}));q._supportedFormats.get(a)},download:function(a,b,c,d){var f=this,
g=null,e=null,h=0,i=!1,j=function(){i&&(i=!1,window.clearInterval(h))},l=3,k=function(){--l;return 0<=l?(e(),!0):!1},e=function(){j();null!=g&&g.abort();g=new XMLHttpRequest;g.open("GET",a,!0);g.responseType=c;var e=0;g.onprogress=function(a){i||(i=!0,h=window.setInterval(function(){4!=g.readyState&&5E3<Date.now()-e&&!k()&&(j(),f.handleError(b,"Download stalled"))},1E3));e=Date.now();f.handleProgress(b,a.loaded)};g.onerror=function(){if(0!=g.status||!k())j(),f.handleError(b,"HTTP error "+g.status)};
g.onload=function(){var a=g.response;null==a&&(a=g.responseText);j();d(a)};g.send()};e()},__class__:q});var Qa=function(a,b){J.call(this,a);this._canvas=b};e["flambe.platform.html.HtmlMouse"]=Qa;Qa.__name__=!0;Qa.__super__=J;Qa.prototype=m(J.prototype,{__class__:Qa});var Ga=function(a){this._disposed=!1;this.audioElement=a};e["flambe.platform.html.HtmlSound"]=Ga;Ga.__name__=!0;Ga.__interfaces__=[ua];Ga.__super__=z;Ga.prototype=m(z.prototype,{play:function(a){null==a&&(a=1);return new kb(this,a,!1)},
onDisposed:function(){this.audioElement=null},__class__:Ga});var kb=function(a,b,c){var d=this;this._sound=a;this._tickableAdded=!1;this._clonedElement=window.document.createElement("audio");this._clonedElement.loop=c;this._clonedElement.src=a.audioElement.src;this.volume=new s(b,function(){d.updateVolume()});this.updateVolume();this._complete=new C(!1);this.playAudio();i.hidden._value&&this.set_paused(!0)};e["flambe.platform.html._HtmlSound.HtmlPlayback"]=kb;kb.__name__=!0;kb.__interfaces__=[hb,
fb];kb.prototype={set_paused:function(a){this._clonedElement.paused!=a&&(a?this._clonedElement.pause():this.playAudio());return a},update:function(a){this.volume.update(a);this._complete.set__(this._clonedElement.ended);return this._complete._value||this._clonedElement.paused?(this._tickableAdded=!1,this._volumeBinding.dispose(),this._hideBinding.dispose(),!0):!1},dispose:function(){this.set_paused(!0);this._complete.set__(!0)},playAudio:function(){var a=this;this._clonedElement.play();this._tickableAdded||
(Y.instance.mainLoop.addTickable(this),this._tickableAdded=!0,this._volumeBinding=i.volume.get_changed().connect(function(){a.updateVolume()}),this._hideBinding=i.hidden.get_changed().connect(function(b){b?(a._wasPaused=a._clonedElement.paused,a.set_paused(!0)):a.set_paused(a._wasPaused)}))},updateVolume:function(){this._clonedElement.volume=i.volume._value*this.volume._value},__class__:kb};var Nb=function(){};e["flambe.subsystem.StageSystem"]=Nb;Nb.__name__=!0;Nb.prototype={__class__:Nb};var oa=
function(a){var b=this;this._canvas=a;this.resize=new X;this.scaleFactor=oa.computeScaleFactor();1!=this.scaleFactor&&(k.setVendorStyle(this._canvas,"transform-origin","top left"),k.setVendorStyle(this._canvas,"transform","scale("+1/this.scaleFactor+")"));k.SHOULD_HIDE_MOBILE_BROWSER&&(window.addEventListener("orientationchange",function(){k.callLater(ma(b,b.hideMobileBrowser),200)},!1),this.hideMobileBrowser());window.addEventListener("resize",ma(this,this.onWindowResize),!1);this.onWindowResize(null);
this.orientation=new C(null);null!=window.orientation&&(window.addEventListener("orientationchange",ma(this,this.onOrientationChange),!1),this.onOrientationChange(null));this.fullscreen=new C(!1);k.addVendorListener(window.document,"fullscreenchange",function(){b.updateFullscreen()},!1);this.updateFullscreen()};e["flambe.platform.html.HtmlStage"]=oa;oa.__name__=!0;oa.__interfaces__=[Nb];oa.computeScaleFactor=function(){var a=window.devicePixelRatio;null==a&&(a=1);var b=window.document.createElement("canvas").getContext("2d"),
b=k.loadExtension("backingStorePixelRatio",b).value;null==b&&(b=1);a/=b;b=window.screen.height;return 1136<a*window.screen.width||1136<a*b?1:a};oa.prototype={get_width:function(){return this._canvas.width},get_height:function(){return this._canvas.height},onWindowResize:function(){var a=this._canvas.parentElement.getBoundingClientRect();this.resizeCanvas(a.width,a.height)},resizeCanvas:function(a,b){var c=this.scaleFactor*a,d=this.scaleFactor*b;if(this._canvas.width==c&&this._canvas.height==d)return!1;
this._canvas.width=c|0;this._canvas.height=d|0;this.resize.emit();return!0},hideMobileBrowser:function(){var a=this,b=window.document.documentElement.style;b.height=window.innerHeight+100+"px";b.width=window.innerWidth+"px";b.overflow="visible";k.callLater(function(){k.hideMobileBrowser();k.callLater(function(){b.height=window.innerHeight+"px";a.onWindowResize(null)},100)})},onOrientationChange:function(){this.orientation.set__(k.orientation(window.orientation))},updateFullscreen:function(){this.fullscreen.set__(!0==
k.loadFirstExtension(["fullscreen","fullScreen","isFullScreen"],window.document).value)},__class__:oa};var k=function(){};e["flambe.platform.html.HtmlUtil"]=k;k.__name__=!0;k.callLater=function(a,b){null==b&&(b=0);window.setTimeout(a,b)};k.hideMobileBrowser=function(){window.scrollTo(1,0)};k.loadExtension=function(a,b){null==b&&(b=window);var c=wa.field(b,a);if(null!=c)return{prefix:"",field:a,value:c};for(var c=a.charAt(0).toUpperCase()+t.substr(a,1,null),d=0,f=k.VENDOR_PREFIXES;d<f.length;){var g=
f[d];++d;var e=g+c,h=wa.field(b,e);if(null!=h)return{prefix:g,field:e,value:h}}return{prefix:null,field:null,value:null}};k.loadFirstExtension=function(a,b){for(var c=0;c<a.length;){var d=a[c];++c;d=k.loadExtension(d,b);if(null!=d.field)return d}return{prefix:null,field:null,value:null}};k.polyfill=function(a,b){null==b&&(b=window);var c=k.loadExtension(a,b).value;if(null==c)return!1;b[a]=c;return!0};k.setVendorStyle=function(a,b,c){for(var a=a.style,d=0,f=k.VENDOR_PREFIXES;d<f.length;){var g=f[d];
++d;a.setProperty("-"+g+"-"+b,c)}a.setProperty(b,c)};k.addVendorListener=function(a,b,c,d){for(var f=0,g=k.VENDOR_PREFIXES;f<g.length;){var e=g[f];++f;a.addEventListener(e+b,c,d)}a.addEventListener(b,c,d)};k.orientation=function(a){switch(a){case -90:case 90:return Z.Landscape;default:return Z.Portrait}};k.createEmptyCanvas=function(a,b){var c;c=window.document.createElement("canvas");c.width=a;c.height=b;return c};k.createCanvas=function(a){var b=k.createEmptyCanvas(a.width,a.height),c=b.getContext("2d");
c.save();c.globalCompositeOperation="copy";c.drawImage(a,0,0);c.restore();return b};k.detectSlowDriver=function(a){if(0<=window.navigator.platform.indexOf("Win")&&null!=window.chrome){for(var b=0,a=a.getSupportedExtensions();b<a.length;){var c=a[b];++b;if(0<=c.indexOf("WEBGL_compressed_texture"))return!1}return!0}return!1};k.fixAndroidMath=function(){if(0<=window.navigator.userAgent.indexOf("Linux; U; Android 4")){var a=Math.sin,b=Math.cos;Math.sin=function(b){return 0==b?0:a(b)};Math.cos=function(a){return 0==
a?1:b(a)}}};var Ob=function(){};e["flambe.subsystem.WebSystem"]=Ob;Ob.__name__=!0;Ob.prototype={__class__:Ob};var Ta=function(a){this._container=a};e["flambe.platform.html.HtmlWeb"]=Ta;Ta.__name__=!0;Ta.__interfaces__=[Ob];Ta.prototype={openBrowser:function(a){window.open(a,"_blank")},__class__:Ta};var r=function(a){this._disposed=!1;this.buffer=a};e["flambe.platform.html.WebAudioSound"]=r;r.__name__=!0;r.__interfaces__=[ua];r.get_supported=function(){if(r._detectSupport){r._detectSupport=!1;var a=
k.loadExtension("AudioContext").value;null!=a&&(r.ctx=new a,r.gain=r.createGain(),r.gain.connect(r.ctx.destination),i.volume.watch(function(a){r.gain.gain.value=a}))}return null!=r.ctx};r.createGain=function(){return null!=r.ctx.createGain?r.ctx.createGain():r.ctx.createGainNode()};r.start=function(a,b){null!=a.start?a.start(b):a.noteOn(b)};r.__super__=z;r.prototype=m(z.prototype,{play:function(a){null==a&&(a=1);return new lb(this,a,!1)},get_duration:function(){return this.buffer.duration},onDisposed:function(){this.buffer=
null},__class__:r});var lb=function(a,b,c){var d=this;this._sound=a;this._head=r.gain;this._complete=new C(!1);this._sourceNode=r.ctx.createBufferSource();this._sourceNode.buffer=a.buffer;this._sourceNode.loop=c;this._sourceNode.onended=function(){d._complete.set__(!0)};r.start(this._sourceNode,0);this.playAudio();this.volume=new s(b,function(a){d.setVolume(a)});1!=b&&this.setVolume(b);i.hidden._value&&this.set_paused(!0)};e["flambe.platform.html._WebAudioSound.WebAudioPlayback"]=lb;lb.__name__=!0;
lb.__interfaces__=[hb,fb];lb.prototype={set_paused:function(a){a!=0<=this._pausedAt&&(a?(this._sourceNode.disconnect(),this._pausedAt=this.get_position()):this.playAudio());return a},get_position:function(){return this._complete._value?this._sound.get_duration():0<=this._pausedAt?this._pausedAt:(r.ctx.currentTime-this._startedAt)%this._sound.get_duration()},update:function(a){this.volume.update(a);3==this._sourceNode.playbackState&&this._complete.set__(!0);return this._complete._value||0<=this._pausedAt?
(this._tickableAdded=!1,this._hideBinding.dispose(),!0):!1},dispose:function(){this.set_paused(!0);this._complete.set__(!0)},setVolume:function(a){null==this._gainNode&&(this._gainNode=r.createGain(),this.insertNode(this._gainNode));this._gainNode.gain.value=a},insertNode:function(a){0<=this._pausedAt||(this._sourceNode.disconnect(),this._sourceNode.connect(a));a.connect(this._head);this._head=a},playAudio:function(){var a=this;this._sourceNode.connect(this._head);this._startedAt=r.ctx.currentTime;
this._pausedAt=-1;this._tickableAdded||(Y.instance.mainLoop.addTickable(this),this._tickableAdded=!0,this._hideBinding=i.hidden.get_changed().connect(function(b){b?(a._wasPaused=0<=a._pausedAt,a.set_paused(!0)):a.set_paused(a._wasPaused)}))},__class__:lb};var Pb=function(a){this._quads=this._maxQuads=this._dataOffset=this._backbufferWidth=this._backbufferHeight=0;this._pendingSetScissor=!1;this._lastBlendMode=this._lastRenderTarget=this._lastShader=this._lastTexture=this._lastScissor=this._currentBlendMode=
this._currentShader=this._currentTexture=this._currentRenderTarget=null;this._gl=a;a.clearColor(0,0,0,0);a.enable(3042);a.pixelStorei(37441,1);this._vertexBuffer=a.createBuffer();a.bindBuffer(34962,this._vertexBuffer);this._quadIndexBuffer=a.createBuffer();a.bindBuffer(34963,this._quadIndexBuffer);this._drawTextureShader=new mb(a);this._drawPatternShader=new nb(a);this._fillRectShader=new ob(a);this.resize(16)};e["flambe.platform.html.WebGLBatcher"]=Pb;Pb.__name__=!0;Pb.prototype={resizeBackbuffer:function(a,
b){this._gl.viewport(0,0,a,b);this._backbufferWidth=a;this._backbufferHeight=b},willRender:function(){},didRender:function(){this.flush()},bindTexture:function(a){this.flush();this._currentTexture=this._lastTexture=null;this._gl.bindTexture(3553,a)},deleteTexture:function(a){null!=this._lastTexture&&this._lastTexture.root==a&&(this.flush(),this._currentTexture=this._lastTexture=null);this._gl.deleteTexture(a.nativeTexture)},deleteFramebuffer:function(a){a==this._lastRenderTarget&&(this.flush(),this._currentRenderTarget=
this._lastRenderTarget=null);this._gl.deleteFramebuffer(a.framebuffer)},prepareDrawTexture:function(a,b,c,d){d!=this._lastTexture&&(this.flush(),this._lastTexture=d);return this.prepareQuad(5,a,b,c,this._drawTextureShader)},prepareDrawPattern:function(a,b,c,d){d!=this._lastTexture&&(this.flush(),this._lastTexture=d);return this.prepareQuad(5,a,b,c,this._drawPatternShader)},prepareFillRect:function(a,b,c){return this.prepareQuad(6,a,b,c,this._fillRectShader)},prepareQuad:function(a,b,c,d,f){b!=this._lastRenderTarget&&
(this.flush(),this._lastRenderTarget=b);c!=this._lastBlendMode&&(this.flush(),this._lastBlendMode=c);f!=this._lastShader&&(this.flush(),this._lastShader=f);if(null!=d||null!=this._lastScissor)if(null==d||null==this._lastScissor||!this._lastScissor.equals(d))this.flush(),this._lastScissor=null!=d?d.clone(this._lastScissor):null,this._pendingSetScissor=!0;this._quads>=this._maxQuads&&this.resize(2*this._maxQuads);++this._quads;b=this._dataOffset;this._dataOffset+=4*a;return b},flush:function(){if(!(1>
this._quads)){this._lastRenderTarget!=this._currentRenderTarget&&this.bindRenderTarget(this._lastRenderTarget);if(this._lastBlendMode!=this._currentBlendMode){switch(this._lastBlendMode[1]){case 0:this._gl.blendFunc(1,771);break;case 1:this._gl.blendFunc(1,1);break;case 2:this._gl.blendFunc(774,771);break;case 3:this._gl.blendFunc(1,769);break;case 4:this._gl.blendFunc(0,770);break;case 5:this._gl.blendFunc(1,0)}this._currentBlendMode=this._lastBlendMode}this._pendingSetScissor&&(null!=this._lastScissor?
(this._gl.enable(3089),this._gl.scissor(this._lastScissor.x|0,this._lastScissor.y|0,this._lastScissor.width|0,this._lastScissor.height|0)):this._gl.disable(3089),this._pendingSetScissor=!1);this._lastTexture!=this._currentTexture&&(this._gl.bindTexture(3553,this._lastTexture.root.nativeTexture),this._currentTexture=this._lastTexture);this._lastShader!=this._currentShader&&(this._lastShader.useProgram(),this._lastShader.prepare(),this._currentShader=this._lastShader);if(this._lastShader==this._drawPatternShader){var a=
this._lastTexture,b=a.root;this._drawPatternShader.setRegion(a.rootX/b.width,a.rootY/b.height,a._width/b.width,a._height/b.height)}this._gl.bufferData(34962,this.data.subarray(0,this._dataOffset),35040);this._gl.drawElements(4,6*this._quads,5123,0);this._dataOffset=this._quads=0}},resize:function(a){this.flush();if(!(1024<a)){this._maxQuads=a;this.data=new Float32Array(24*a);this._gl.bufferData(34962,4*this.data.length,35040);for(var b=new Uint16Array(6*a),c=0;c<a;){var d=c++;b[6*d]=4*d;b[6*d+1]=
4*d+1;b[6*d+2]=4*d+2;b[6*d+3]=4*d+2;b[6*d+4]=4*d+3;b[6*d+5]=4*d}this._gl.bufferData(34963,b,35044)}},bindRenderTarget:function(a){null!=a?(this._gl.bindFramebuffer(36160,a.framebuffer),this._gl.viewport(0,0,a.width,a.height)):(this._gl.bindFramebuffer(36160,null),this._gl.viewport(0,0,this._backbufferWidth,this._backbufferHeight));this._lastRenderTarget=this._currentRenderTarget=a},__class__:Pb};var S=function(a,b){this._inverseProjection=this._stateList=null;null==S._scratchQuadArray&&(S._scratchQuadArray=
new Float32Array(8));this._batcher=a;this._renderTarget=b};e["flambe.platform.html.WebGLGraphics"]=S;S.__name__=!0;S.__interfaces__=[Da];S.prototype={save:function(){var a=this._stateList,b=this._stateList.next;null==b&&(b=new pb,b.prev=a,a.next=b);a.matrix.clone(b.matrix);b.alpha=a.alpha;b.blendMode=a.blendMode;b.scissor=null!=a.scissor?a.scissor.clone(b.scissor):null;this._stateList=b},transform:function(a,b,c,d,f,g){var e=this._stateList;S._scratchMatrix.set(a,b,c,d,f,g);Q.multiply(e.matrix,S._scratchMatrix,
e.matrix)},restore:function(){this._stateList=this._stateList.prev},drawTexture:function(a,b,c){this.drawSubTexture(a,b,c,0,0,a.get_width(),a.get_height())},drawSubTexture:function(a,b,c,d,f,g,e){var h=this._stateList,i=a.root,b=this.transformQuad(b,c,g,e),c=i.width,i=i.height,d=(a.rootX+d)/c,f=(a.rootY+f)/i,g=d+g/c,e=f+e/i,c=h.alpha,a=this._batcher.prepareDrawTexture(this._renderTarget,h.blendMode,h.scissor,a),h=this._batcher.data;h[a]=b[0];h[++a]=b[1];h[++a]=d;h[++a]=f;h[++a]=c;h[++a]=b[2];h[++a]=
b[3];h[++a]=g;h[++a]=f;h[++a]=c;h[++a]=b[4];h[++a]=b[5];h[++a]=g;h[++a]=e;h[++a]=c;h[++a]=b[6];h[++a]=b[7];h[++a]=d;h[++a]=e;h[++a]=c},drawPattern:function(a,b,c,d,f){var g=this._stateList,e=a.root,b=this.transformQuad(b,c,d,f),d=d/e.width,f=f/e.height,e=g.alpha,a=this._batcher.prepareDrawPattern(this._renderTarget,g.blendMode,g.scissor,a),g=this._batcher.data;g[a]=b[0];g[++a]=b[1];g[++a]=0;g[++a]=0;g[++a]=e;g[++a]=b[2];g[++a]=b[3];g[++a]=d;g[++a]=0;g[++a]=e;g[++a]=b[4];g[++a]=b[5];g[++a]=d;g[++a]=
f;g[++a]=e;g[++a]=b[6];g[++a]=b[7];g[++a]=0;g[++a]=f;g[++a]=e},fillRect:function(a,b,c,d,f){var g=this._stateList,b=this.transformQuad(b,c,d,f),c=(a&16711680)/16711680,d=(a&65280)/65280,a=(a&255)/255,f=g.alpha,g=this._batcher.prepareFillRect(this._renderTarget,g.blendMode,g.scissor),e=this._batcher.data;e[g]=b[0];e[++g]=b[1];e[++g]=c;e[++g]=d;e[++g]=a;e[++g]=f;e[++g]=b[2];e[++g]=b[3];e[++g]=c;e[++g]=d;e[++g]=a;e[++g]=f;e[++g]=b[4];e[++g]=b[5];e[++g]=c;e[++g]=d;e[++g]=a;e[++g]=f;e[++g]=b[6];e[++g]=
b[7];e[++g]=c;e[++g]=d;e[++g]=a;e[++g]=f},multiplyAlpha:function(a){this._stateList.alpha*=a},setBlendMode:function(a){this._stateList.blendMode=a},applyScissor:function(a,b,c,d){var f=this._stateList,g=S._scratchQuadArray;g[0]=a;g[1]=b;g[2]=a+c;g[3]=b+d;f.matrix.transformArray(g,4,g);this._inverseProjection.transformArray(g,4,g);a=g[0];b=g[1];c=g[2]-a;d=g[3]-b;0>c&&(a+=c,c=-c);0>d&&(b+=d,d=-d);f.applyScissor(a,b,c,d)},willRender:function(){this._batcher.willRender()},didRender:function(){this._batcher.didRender()},
onResize:function(a,b){this._stateList=new pb;var c;c=null!=this._renderTarget?-1:1;this._stateList.matrix.set(2/a,0,0,-2*c/b,-1,c);this._inverseProjection=new Q;this._inverseProjection.set(2/a,0,0,2/b,-1,-1);this._inverseProjection.invert()},transformQuad:function(a,b,c,d){var c=a+c,d=b+d,f=S._scratchQuadArray;f[0]=a;f[1]=b;f[2]=c;f[3]=b;f[4]=c;f[5]=d;f[6]=a;f[7]=d;this._stateList.matrix.transformArray(f,8,f);return f},__class__:S};var pb=function(){this.scissor=this.prev=this.next=null;this.matrix=
new Q;this.alpha=1;this.blendMode=u.Normal};e["flambe.platform.html._WebGLGraphics.DrawingState"]=pb;pb.__name__=!0;pb.prototype={applyScissor:function(a,b,c,d){if(null!=this.scissor)var f=I.max(this.scissor.x,a),g=I.max(this.scissor.y,b),c=I.min(this.scissor.x+this.scissor.width,a+c),d=I.min(this.scissor.y+this.scissor.height,b+d),a=f,b=g,c=c-f,d=d-g;else this.scissor=new sa;this.scissor.set(Math.round(a),Math.round(b),Math.round(c),Math.round(d))},__class__:pb};var Ua=function(a,b){var c=this;this._hasGPU=
new C(!0);this.gl=b;b.canvas.addEventListener("webglcontextlost",function(a){a.preventDefault();c._hasGPU.set__(!1)},!1);b.canvas.addEventListener("webglcontextrestore",function(){c.init();c._hasGPU.set__(!0)},!1);a.resize.connect(ma(this,this.onResize));this.init()};e["flambe.platform.html.WebGLRenderer"]=Ua;Ua.__name__=!0;Ua.__interfaces__=[Ea];Ua.prototype={get_type:function(){return N.WebGL},createTextureFromImage:function(a){if(this.gl.isContextLost())return null;var b=new ga(this,a.width,a.height);
b.uploadImageData(a);return b.createTexture(a.width,a.height)},getCompressedTextureFormats:function(){return[]},createCompressedTexture:function(){this.gl.isContextLost();return null},willRender:function(){this.graphics.willRender()},didRender:function(){this.graphics.didRender()},onResize:function(){var a=this.gl.canvas.width,b=this.gl.canvas.height;this.batcher.resizeBackbuffer(a,b);this.graphics.onResize(a,b)},init:function(){this.batcher=new Pb(this.gl);this.graphics=new S(this.batcher,null);
this.onResize()},__class__:Ua};var qb=function(a,b,c){U.call(this,a,b,c)};e["flambe.platform.html.WebGLTexture"]=qb;qb.__name__=!0;qb.__super__=U;qb.prototype=m(U.prototype,{__class__:qb});var ga=function(a,b,c){this.framebuffer=this._graphics=null;this._disposed=!1;this._renderer=a;this.width=I.max(2,Mb.nextPowerOfTwo(b));this.height=I.max(2,Mb.nextPowerOfTwo(c));b=a.gl;this.nativeTexture=b.createTexture();a.batcher.bindTexture(this.nativeTexture);b.texParameteri(3553,10242,33071);b.texParameteri(3553,
10243,33071);b.texParameteri(3553,10240,9729);b.texParameteri(3553,10241,9728)};e["flambe.platform.html.WebGLTextureRoot"]=ga;ga.__name__=!0;ga.__interfaces__=[gb];ga.drawBorder=function(a,b,c){var d=a.getContext("2d");d.drawImage(a,b-1,0,1,c,b,0,1,c);d.drawImage(a,0,c-1,b,1,0,c,b,1)};ga.__super__=z;ga.prototype=m(z.prototype,{createTexture:function(a,b){return new qb(this,a,b)},uploadImageData:function(a){if(this.width!=a.width||this.height!=a.height){var b=k.createEmptyCanvas(this.width,this.height);
b.getContext("2d").drawImage(a,0,0);ga.drawBorder(b,a.width,a.height);a=b}this._renderer.batcher.bindTexture(this.nativeTexture);this._renderer.gl.texImage2D(3553,0,6408,6408,5121,a)},onDisposed:function(){var a=this._renderer.batcher;a.deleteTexture(this);null!=this.framebuffer&&a.deleteFramebuffer(this);this._graphics=this.framebuffer=this.nativeTexture=null},__class__:ga});var G=function(a,b,c){c="#ifdef GL_ES\nprecision mediump float;\n#endif\n"+c;this._gl=a;this._program=a.createProgram();a.attachShader(this._program,
G.createShader(a,35633,b));a.attachShader(this._program,G.createShader(a,35632,c));a.linkProgram(this._program);a.useProgram(this._program)};e["flambe.platform.shader.ShaderGL"]=G;G.__name__=!0;G.createShader=function(a,b,c){b=a.createShader(b);a.shaderSource(b,c);a.compileShader(b);return b};G.prototype={useProgram:function(){this._gl.useProgram(this._program)},prepare:function(){null},getAttribLocation:function(a){return this._gl.getAttribLocation(this._program,a)},getUniformLocation:function(a){return this._gl.getUniformLocation(this._program,
a)},__class__:G};var nb=function(a){G.call(this,a,"attribute highp vec2 a_pos;\nattribute mediump vec2 a_uv;\nattribute lowp float a_alpha;\nvarying mediump vec2 v_uv;\nvarying lowp float v_alpha;\nvoid main (void) {\nv_uv = a_uv;\nv_alpha = a_alpha;\ngl_Position = vec4(a_pos, 0, 1);\n}","varying mediump vec2 v_uv;\nvarying lowp float v_alpha;\nuniform lowp sampler2D u_texture;\nuniform mediump vec4 u_region;\nvoid main (void) {\ngl_FragColor = texture2D(u_texture, u_region.xy + mod(v_uv, u_region.zw)) * v_alpha;\n}");
this.a_pos=this.getAttribLocation("a_pos");this.a_uv=this.getAttribLocation("a_uv");this.a_alpha=this.getAttribLocation("a_alpha");this.u_texture=this.getUniformLocation("u_texture");this.u_region=this.getUniformLocation("u_region");this.setTexture(0)};e["flambe.platform.shader.DrawPatternGL"]=nb;nb.__name__=!0;nb.__super__=G;nb.prototype=m(G.prototype,{setTexture:function(a){this._gl.uniform1i(this.u_texture,a)},setRegion:function(a,b,c,d){this._gl.uniform4f(this.u_region,a,b,c,d)},prepare:function(){this._gl.enableVertexAttribArray(this.a_pos);
this._gl.enableVertexAttribArray(this.a_uv);this._gl.enableVertexAttribArray(this.a_alpha);this._gl.vertexAttribPointer(this.a_pos,2,5126,!1,20,0);this._gl.vertexAttribPointer(this.a_uv,2,5126,!1,20,8);this._gl.vertexAttribPointer(this.a_alpha,1,5126,!1,20,16)},__class__:nb});var mb=function(a){G.call(this,a,"attribute highp vec2 a_pos;\nattribute mediump vec2 a_uv;\nattribute lowp float a_alpha;\nvarying mediump vec2 v_uv;\nvarying lowp float v_alpha;\nvoid main (void) {\nv_uv = a_uv;\nv_alpha = a_alpha;\ngl_Position = vec4(a_pos, 0, 1);\n}",
"varying mediump vec2 v_uv;\nvarying lowp float v_alpha;\nuniform lowp sampler2D u_texture;\nvoid main (void) {\ngl_FragColor = texture2D(u_texture, v_uv) * v_alpha;\n}");this.a_pos=this.getAttribLocation("a_pos");this.a_uv=this.getAttribLocation("a_uv");this.a_alpha=this.getAttribLocation("a_alpha");this.u_texture=this.getUniformLocation("u_texture");this.setTexture(0)};e["flambe.platform.shader.DrawTextureGL"]=mb;mb.__name__=!0;mb.__super__=G;mb.prototype=m(G.prototype,{setTexture:function(a){this._gl.uniform1i(this.u_texture,
a)},prepare:function(){this._gl.enableVertexAttribArray(this.a_pos);this._gl.enableVertexAttribArray(this.a_uv);this._gl.enableVertexAttribArray(this.a_alpha);this._gl.vertexAttribPointer(this.a_pos,2,5126,!1,20,0);this._gl.vertexAttribPointer(this.a_uv,2,5126,!1,20,8);this._gl.vertexAttribPointer(this.a_alpha,1,5126,!1,20,16)},__class__:mb});var ob=function(a){G.call(this,a,"attribute highp vec2 a_pos;\nattribute lowp vec3 a_rgb;\nattribute lowp float a_alpha;\nvarying lowp vec4 v_color;\nvoid main (void) {\nv_color = vec4(a_rgb*a_alpha, a_alpha);\ngl_Position = vec4(a_pos, 0, 1);\n}",
"varying lowp vec4 v_color;\nvoid main (void) {\ngl_FragColor = v_color;\n}");this.a_pos=this.getAttribLocation("a_pos");this.a_rgb=this.getAttribLocation("a_rgb");this.a_alpha=this.getAttribLocation("a_alpha")};e["flambe.platform.shader.FillRectGL"]=ob;ob.__name__=!0;ob.__super__=G;ob.prototype=m(G.prototype,{prepare:function(){this._gl.enableVertexAttribArray(this.a_pos);this._gl.enableVertexAttribArray(this.a_rgb);this._gl.enableVertexAttribArray(this.a_alpha);this._gl.vertexAttribPointer(this.a_pos,
2,5126,!1,24,0);this._gl.vertexAttribPointer(this.a_rgb,3,5126,!1,24,8);this._gl.vertexAttribPointer(this.a_alpha,1,5126,!1,24,20)},__class__:ob});var rb=function(){this._width=this._height=-1;this._transitor=null;p.call(this);this.scenes=[];this.occludedScenes=[];this._root=new l};e["flambe.scene.Director"]=rb;rb.__name__=!0;rb.__super__=p;rb.prototype=m(p.prototype,{get_name:function(){return"Director_1"},pushScene:function(a,b){var c=this;this.completeTransition();var d=this.get_topScene();null!=
d?this.playTransition(d,a,b,function(){c.hide(d)}):(this.add(a),this.invalidateVisibility())},popScene:function(a){var b=this;this.completeTransition();var c=this.get_topScene();if(null!=c){this.scenes.pop();var d=this.get_topScene();null!=d?this.playTransition(c,d,a,function(){b.hideAndDispose(c)}):(this.hideAndDispose(c),this.invalidateVisibility())}},unwindToScene:function(a,b){var c=this;this.completeTransition();var d=this.get_topScene();if(null!=d){if(d!=a){for(this.scenes.pop();0<this.scenes.length&&
this.scenes[this.scenes.length-1]!=a;)this.scenes.pop().dispose();this.playTransition(d,a,b,function(){c.hideAndDispose(d)})}}else this.pushScene(a,b)},onAdded:function(){this.owner.addChild(this._root)},onRemoved:function(){this.completeTransition();for(var a=0,b=this.scenes;a<b.length;){var c=b[a];++a;c.dispose()}this.scenes=[];this.occludedScenes=[];this._root.dispose()},onUpdate:function(a){null!=this._transitor&&this._transitor.update(a)&&this.completeTransition()},get_topScene:function(){var a=
this.scenes.length;return 0<a?this.scenes[a-1]:null},add:function(a){var b=this.get_topScene();null!=b&&this._root.removeChild(b);t.remove(this.scenes,a);this.scenes.push(a);this._root.addChild(a)},hide:function(a){a=a._compMap.Scene_3;null!=a&&a.hidden.emit()},hideAndDispose:function(a){this.hide(a);a.dispose()},show:function(a){a=a._compMap.Scene_3;null!=a&&a.shown.emit()},invalidateVisibility:function(){for(var a=this.scenes.length;0<a;){var b=this.scenes[--a]._compMap.Scene_3;if(null==b||b.opaque)break}this.occludedScenes=
0<this.scenes.length?this.scenes.slice(a,this.scenes.length-1):[];a=this.get_topScene();null!=a&&this.show(a)},completeTransition:function(){null!=this._transitor&&(this._transitor.complete(),this._transitor=null,this.invalidateVisibility())},playTransition:function(a,b,c,d){this.completeTransition();this.add(b);null!=c?(this.occludedScenes.push(a),this._transitor=new Qb(a,b,c,d),this._transitor.init(this)):(d(),this.invalidateVisibility())},get_width:function(){return 0>this._width?i._platform.getStage().get_width():
this._width},get_height:function(){return 0>this._height?i._platform.getStage().get_height():this._height},__class__:rb});var Qb=function(a,b,c,d){this._from=a;this._to=b;this._transition=c;this._onComplete=d};e["flambe.scene._Director.Transitor"]=Qb;Qb.__name__=!0;Qb.prototype={init:function(a){this._transition.init(a,this._from,this._to)},update:function(a){return this._transition.update(a)},complete:function(){this._transition.complete();this._onComplete()},__class__:Qb};var sb=function(a){null==
a&&(a=!0);p.call(this);this.opaque=a;this.shown=new X;this.hidden=new X};e["flambe.scene.Scene"]=sb;sb.__name__=!0;sb.__super__=p;sb.prototype=m(p.prototype,{get_name:function(){return"Scene_3"},__class__:sb});var Ha=function(){};e["flambe.scene.Transition"]=Ha;Ha.__name__=!0;Ha.prototype={init:function(a,b,c){this._director=a;this._from=b;this._to=c},update:function(){return!0},complete:function(){},__class__:Ha};var $=function(a,b){this._duration=a;this._ease=null!=b?b:P.linear};e["flambe.scene.TweenTransition"]=
$;$.__name__=!0;$.__super__=Ha;$.prototype=m(Ha.prototype,{init:function(a,b,c){Ha.prototype.init.call(this,a,b,c);this._elapsed=0},update:function(a){this._elapsed+=a;return this._elapsed>=this._duration},interp:function(a,b){return a+(b-a)*this._ease(this._elapsed/this._duration)},__class__:$});var Ia=function(a,b){this._direction=2;$.call(this,a,b)};e["flambe.scene.SlideTransition"]=Ia;Ia.__name__=!0;Ia.__super__=$;Ia.prototype=m($.prototype,{init:function(a,b,c){$.prototype.init.call(this,a,b,
c);switch(this._direction){case 0:this._x=0;this._y=-this._director.get_height();break;case 1:this._x=0;this._y=this._director.get_height();break;case 2:this._x=-this._director.get_width();this._y=0;break;case 3:this._x=this._director.get_width(),this._y=0}a=this._from._compMap.Sprite_0;null==a&&this._from.add(a=new j);a.setXY(0,0);a=this._to._compMap.Sprite_0;null==a&&this._to.add(a=new j);a.setXY(-this._x,-this._y)},update:function(a){a=$.prototype.update.call(this,a);this._from._compMap.Sprite_0.setXY(this.interp(0,
this._x),this.interp(0,this._y));this._to._compMap.Sprite_0.setXY(this.interp(-this._x,0),this.interp(-this._y,0));return a},complete:function(){this._from._compMap.Sprite_0.setXY(0,0);this._to._compMap.Sprite_0.setXY(0,0)},__class__:Ia});var ha=function(){};e["flambe.script.Action"]=ha;ha.__name__=!0;ha.prototype={__class__:ha};var tb=function(a,b,c,d){this._value=a;this._to=b;this._seconds=c;this._easing=d};e["flambe.script.AnimateTo"]=tb;tb.__name__=!0;tb.__interfaces__=[ha];tb.prototype={update:function(a){null==
this._tween&&(this._tween=new za(this._value._value,this._to,this._seconds,this._easing),this._value.set_behavior(this._tween),this._value.update(a));if(this._value._behavior!=this._tween){var b=this._tween.elapsed-this._seconds;this._tween=null;return 0<b?Math.max(0,a-b):0}return-1},__class__:tb};var ia=function(a){this._fn=a};e["flambe.script.CallFunction"]=ia;ia.__name__=!0;ia.__interfaces__=[ha];ia.prototype={update:function(){this._fn();return 0},__class__:ia};var va=function(a){this._duration=
a;this._elapsed=0};e["flambe.script.Delay"]=va;va.__name__=!0;va.__interfaces__=[ha];va.prototype={update:function(a){this._elapsed+=a;if(this._elapsed>=this._duration){var b=this._elapsed-this._duration;this._elapsed=0;return a-b}return-1},__class__:va};var Ja=function(a,b){null==b&&(b=-1);this._action=a;this._remaining=this._count=b};e["flambe.script.Repeat"]=Ja;Ja.__name__=!0;Ja.__interfaces__=[ha];Ja.prototype={update:function(a,b){if(0==this._count)return 0;var c=this._action.update(a,b);return 0<
this._count&&0<=c&&0==--this._remaining?(this._remaining=this._count,c):-1},__class__:Ja};var ja=function(){p.call(this);this.stopAll()};e["flambe.script.Script"]=ja;ja.__name__=!0;ja.__super__=p;ja.prototype=m(p.prototype,{get_name:function(){return"Script_9"},run:function(a){a=new ub(a);this._handles.push(a);return a},stopAll:function(){this._handles=[]},onUpdate:function(a){for(var b=0;b<this._handles.length;){var c=this._handles[b];c.removed||0<=c.action.update(a,this.owner)?this._handles.splice(b,
1):++b}},__class__:ja});var ub=function(a){this.removed=!1;this.action=a};e["flambe.script._Script.Handle"]=ub;ub.__name__=!0;ub.__interfaces__=[T];ub.prototype={dispose:function(){this.removed=!0;this.action=null},__class__:ub};var ka=function(a){this._idx=0;this._runningActions=null!=a?a.slice():[]};e["flambe.script.Sequence"]=ka;ka.__name__=!0;ka.__interfaces__=[ha];ka.prototype={update:function(a,b){for(var c=0;;){var d=this._runningActions[this._idx];if(null!=d)if(d=d.update(a-c,b),0<=d)c+=d;
else return-1;++this._idx;if(this._idx>=this._runningActions.length){this._idx=0;break}else if(c>a)return-1}return c},__class__:ka};var N=e["flambe.subsystem.RendererType"]={__ename__:!0,__constructs__:["Stage3D","WebGL","Canvas"]};N.Stage3D=["Stage3D",0];N.Stage3D.toString=n;N.Stage3D.__enum__=N;N.WebGL=["WebGL",1];N.WebGL.toString=n;N.WebGL.__enum__=N;N.Canvas=["Canvas",2];N.Canvas.toString=n;N.Canvas.__enum__=N;var vb=function(){};e["flambe.swf.Symbol"]=vb;vb.__name__=!0;vb.prototype={__class__:vb};
var Sb=function(a,b){this.name=a;var c=1/b.length;this.frames=[];for(var d=0;d<b.length;){var f=b[d];++d;this.frames.push(new Rb(f,c))}};e["flambe.swf.Flipbook"]=Sb;Sb.__name__=!0;Sb.prototype={setDuration:function(a){for(var a=a/this.frames.length,b=0,c=this.frames;b<c.length;){var d=c[b];++b;d.duration=a}return this},setAnchor:function(a,b){for(var c=0,d=this.frames;c<d.length;){var f=d[c];++c;f.anchorX=a;f.anchorY=b}return this},__class__:Sb};var Rb=function(a,b){this.label=null;this.anchorX=this.anchorY=
0;this.texture=a;this.duration=b};e["flambe.swf.FlipbookFrame"]=Rb;Rb.__name__=!0;Rb.prototype={toSymbol:function(){return new wb(this)},__class__:Rb};var wb=function(a){this._texture=a.texture;this._anchorX=a.anchorX;this._anchorY=a.anchorY};e["flambe.swf._Flipbook.FrameSymbol"]=wb;wb.__name__=!0;wb.__interfaces__=[vb];wb.prototype={createSprite:function(){var a=new D(this._texture);a.setAnchor(this._anchorX,this._anchorY);return a},__class__:wb};var Ka=function(){};e["flambe.swf.Library"]=Ka;Ka.__name__=
!0;Ka.fromFlipbooks=function(a){var b=na.createEmptyInstance(Ka);b._symbols=new L;b.frameRate=60;b._file=null;for(var c=0;c<a.length;){var d=a[c];++c;for(var f=[],g=0,e=d.frames;g<e.length;){var h=e[g];++g;f.push({duration:h.duration*b.frameRate,label:h.label,pivot:[h.anchorX,h.anchorY],ref:""})}f=new xb(b,{id:d.name,layers:[{name:"flipbook",flipbook:!0,keyframes:f}]});b._symbols.set(d.name,f);f=f.layers[0].keyframes;g=0;for(e=d.frames.length;g<e;)h=g++,f[h].setSymbol(d.frames[h].toSymbol())}return b};
Ka.prototype={createSprite:function(a,b){null==b&&(b=!0);var c=this._symbols.get(a);if(null==c){if(b)throw x.withFields("Missing symbol",["name",a]);return null}return c.createSprite()},__class__:Ka};var La=function(a){this._looped=null;j.call(this);this.symbol=a;this.speed=new s(1);this._animators=Array(a.layers.length);for(var b=0,c=this._animators.length;b<c;){var d=b++;this._animators[d]=new Tb(a.layers[d])}this._position=this._frame=0;this["goto"](1)};e["flambe.swf.MovieSprite"]=La;La.__name__=
!0;La.__super__=j;La.prototype=m(j.prototype,{onAdded:function(){j.prototype.onAdded.call(this);for(var a=0,b=this._animators;a<b.length;){var c=b[a];++a;this.owner.addChild(c.content)}},onRemoved:function(){j.prototype.onRemoved.call(this);for(var a=0,b=this._animators;a<b.length;){var c=b[a];++a;this.owner.removeChild(c.content)}},onUpdate:function(a){j.prototype.onUpdate.call(this,a);this.speed.update(a);switch(this._flags&384){case 0:this._position+=this.speed._value*a;this._position>this.symbol.duration&&
(this._position%=this.symbol.duration,null!=this._looped&&this._looped.emit());break;case 256:this._flags&=-257}this["goto"](this._position*this.symbol.frameRate)},"goto":function(a){if(this._frame!=a){if(a<this._frame)for(var b=0,c=this._animators;b<c.length;){var d=c[b];++b;d.needsKeyframeUpdate=!0;d.keyframeIdx=0}b=0;for(c=this._animators;b<c.length;)d=c[b],++b,d.composeFrame(a);this._frame=a}},get_looped:function(){null==this._looped&&(this._looped=new X);return this._looped},rewind:function(){this._position=
0;this._flags|=256},__class__:La});var Tb=function(a){this.keyframeIdx=0;this.needsKeyframeUpdate=!1;this.layer=a;this.content=new l;if(a.empty)this._sprites=null;else{this._sprites=Array(a.keyframes.length);for(var b=0,c=this._sprites.length;b<c;){var d=b++,f=a.keyframes[d];this._sprites[d]=0<d&&a.keyframes[d-1].symbol==f.symbol?this._sprites[d-1]:null==f.symbol?new j:f.symbol.createSprite()}this.content.add(this._sprites[0])}};e["flambe.swf._MovieSprite.LayerAnimator"]=Tb;Tb.__name__=!0;Tb.prototype=
{composeFrame:function(a){if(null!=this._sprites){var b=this.layer.keyframes,c=b.length-1;if(a>this.layer.frames)this.content._compMap.Sprite_0.set_visible(!1),this.keyframeIdx=c,this.needsKeyframeUpdate=!0;else{for(;this.keyframeIdx<c&&b[this.keyframeIdx+1].index<=a;)++this.keyframeIdx,this.needsKeyframeUpdate=!0;var d;this.needsKeyframeUpdate?(this.needsKeyframeUpdate=!1,d=this._sprites[this.keyframeIdx],d!=this.content._compMap.Sprite_0&&(na.getClass(d)==La&&d.rewind(),this.content.add(d))):d=
this.content._compMap.Sprite_0;var f=b[this.keyframeIdx],e=f.visible&&null!=f.symbol;d.set_visible(e);if(e){var e=f.x,h=f.y,i=f.scaleX,j=f.scaleY,l=f.skewX,k=f.skewY,n=f.alpha;if(f.tweened&&this.keyframeIdx<c){a=(a-f.index)/f.duration;c=f.ease;if(0!=c){var m;0>c?(m=1-a,m=1-m*m,c=-c):m=a*a;a=c*m+(1-c)*a}b=b[this.keyframeIdx+1];e+=(b.x-e)*a;h+=(b.y-h)*a;i+=(b.scaleX-i)*a;j+=(b.scaleY-j)*a;l+=(b.skewX-l)*a;k+=(b.skewY-k)*a;n+=(b.alpha-n)*a}b=d.getLocalMatrix();a=Math.sin(l);l=Math.cos(l);c=Math.sin(k);
k=Math.cos(k);b.set(k*i,c*i,-a*j,l*j,e,h);b.translate(-f.pivotX,-f.pivotY);d.alpha.set__(n)}}}},__class__:Tb};var xb=function(a,b){this._name=b.id;this.frameRate=a.frameRate;this.frames=0;this.layers=Array(b.layers.length);for(var c=0,d=this.layers.length;c<d;){var f=c++,e=new Ub(b.layers[f]);this.frames=Math.max(e.frames,this.frames);this.layers[f]=e}this.duration=this.frames/this.frameRate};e["flambe.swf.MovieSymbol"]=xb;xb.__name__=!0;xb.__interfaces__=[vb];xb.prototype={createSprite:function(){return new La(this)},
__class__:xb};var Ub=function(a){this.empty=!0;this.name=a.name;var b=null;this.keyframes=Array(a.keyframes.length);for(var c=0,d=this.keyframes.length;c<d;){var f=c++,b=new Vb(a.keyframes[f],b);this.keyframes[f]=b;this.empty=this.empty&&null==b.symbolName}this.frames=null!=b?b.index+b.duration:0};e["flambe.swf.MovieLayer"]=Ub;Ub.__name__=!0;Ub.prototype={__class__:Ub};var Vb=function(a,b){this.ease=0;this.visible=this.tweened=!0;this.alpha=1;this.skewX=this.skewY=this.pivotX=this.pivotY=0;this.scaleX=
this.scaleY=1;this.x=this.y=0;this.symbol=null;this.index=null!=b?b.index+b.duration:0;this.duration=a.duration;this.label=a.label;this.symbolName=a.ref;var c=a.loc;null!=c&&(this.x=c[0],this.y=c[1]);c=a.scale;null!=c&&(this.scaleX=c[0],this.scaleY=c[1]);c=a.skew;null!=c&&(this.skewX=c[0],this.skewY=c[1]);c=a.pivot;null!=c&&(this.pivotX=c[0],this.pivotY=c[1]);null!=a.alpha&&(this.alpha=a.alpha);null!=a.visible&&(this.visible=a.visible);null!=a.tweened&&(this.tweened=a.tweened);null!=a.ease&&(this.ease=
a.ease)};e["flambe.swf.MovieKeyframe"]=Vb;Vb.__name__=!0;Vb.prototype={setSymbol:function(a){this.symbol=a},__class__:Vb};var ac=function(){};e["flambe.util.Assert"]=ac;ac.__name__=!0;ac.that=function(){};var bc=function(){};e["flambe.util.BitSets"]=bc;bc.__name__=!0;bc.set=function(a,b,c){return c?a|b:a&~b};var Ma=function(){this.mainSection=new L;this.sections=new L};e["flambe.util.Config"]=Ma;Ma.__name__=!0;Ma.parse=function(a){for(var b=new Ma,c=new K("^\\s*;",""),d=new K("^\\s*\\[\\s*([^\\]]*)\\s*\\]",
""),f=new K("^\\s*([\\w\\.\\-_]+)\\s*=\\s*(.*)",""),e=b.mainSection,h=0,a=(new K("\r\n|\r|\n","g")).split(a);h<a.length;){var i=a[h];++h;if(!c.match(i))if(d.match(i))i=d.matched(1),b.sections.exists(i)?e=b.sections.get(i):(e=new L,b.sections.set(i,e));else if(f.match(i)){var i=f.matched(1),j=f.matched(2),l=j.charCodeAt(0);if((34==l||39==l)&&j.charCodeAt(j.length-1)==l)j=t.substr(j,1,j.length-2);j=O.replace(O.replace(O.replace(O.replace(O.replace(O.replace(j,"\\n","\n"),"\\r","\r"),"\\t","\t"),"\\'",
"'"),'\\"','"'),"\\\\","\\");e.set(i,j)}}return b};Ma.prototype={get:function(a){var b=a.indexOf(".");if(0>b)return this.mainSection.get(a);var c;c=this.sections.get(t.substr(a,0,b));return null!=c?(a=t.substr(a,b+1,null),c.get(a)):null},__class__:Ma};var Na=function(a){this.config=a;this.missingTranslation=new v};e["flambe.util.MessageBundle"]=Na;Na.__name__=!0;Na.parse=function(a){return new Na(Ma.parse(a))};Na.prototype={get:function(a,b){var c=this.config.get(a);return null==c?(this.missingTranslation.emit(a),
a):null!=b?x.substitute(c,b):c},__class__:Na};var bb=function(){this.success=new v;this.error=new v;this.progressChanged=new X;this.hasResult=!1;this._total=this._progress=0};e["flambe.util.Promise"]=bb;bb.__name__=!0;bb.prototype={set_result:function(a){if(this.hasResult)throw"Promise result already assigned";this._result=a;this.hasResult=!0;this.success.emit(a);return a},get:function(a){return this.hasResult?(a(this._result),null):this.success.connect(a).once()},set_progress:function(a){this._progress!=
a&&(this._progress=a,this.progressChanged.emit());return a},set_total:function(a){this._total!=a&&(this._total=a,this.progressChanged.emit());return a},__class__:bb};var X=function(a){w.call(this,a)};e["flambe.util.Signal0"]=X;X.__name__=!0;X.__super__=w;X.prototype=m(w.prototype,{connect:function(a,b){null==b&&(b=!1);return this.connectImpl(a,b)},emit:function(){var a=this;this._head==w.DISPATCHING_SENTINEL?this.defer(function(){a.emitImpl()}):this.emitImpl()},emitImpl:function(){for(var a=this.willEmit(),
b=a;null!=b;)b._listener(),b.stayInList||b.dispose(),b=b._next;this.didEmit(a)},__class__:X});var Ab=function(a){this.next=null;this.fn=a};e["flambe.util._SignalBase.Task"]=Ab;Ab.__name__=!0;Ab.prototype={__class__:Ab};var x=function(){};e["flambe.util.Strings"]=x;x.__name__=!0;x.getFileExtension=function(a){var b=a.lastIndexOf(".");return 0<b?t.substr(a,b+1,null):null};x.removeFileExtension=function(a){var b=a.lastIndexOf(".");return 0<b?t.substr(a,0,b):a};x.getUrlExtension=function(a){var b=a.lastIndexOf("?");
0<=b&&(a=t.substr(a,0,b));b=a.lastIndexOf("/");0<=b&&(a=t.substr(a,b+1,null));return x.getFileExtension(a)};x.joinPath=function(a,b){0<a.length&&47!=a.charCodeAt(a.length-1)&&(a+="/");return a+b};x.substitute=function(a,b){for(var c=0,d=b.length;c<d;)var f=c++,a=O.replace(a,"{"+f+"}",b[f]);return a};x.withFields=function(a,b){var c=b.length;if(0<c){for(var a=0<a.length?a+" [":a+"[",d=0;d<c;){0<d&&(a+=", ");var f=b[d],e=b[d+1];if(F.is(e,Error)){var h=e.stack;null!=h&&(e=h)}a+=f+"="+F.string(e);d+=
2}a+="]"}return a};var W=function(){this.h={}};e["haxe.ds.IntMap"]=W;W.__name__=!0;W.__interfaces__=[Xb];W.prototype={set:function(a,b){this.h[a]=b},get:function(a){return this.h[a]},exists:function(a){return this.h.hasOwnProperty(a)},remove:function(a){if(!this.h.hasOwnProperty(a))return!1;delete this.h[a];return!0},__class__:W};var L=function(){this.h={}};e["haxe.ds.StringMap"]=L;L.__name__=!0;L.__interfaces__=[Xb];L.prototype={set:function(a,b){this.h["$"+a]=b},get:function(a){return this.h["$"+
a]},exists:function(a){return this.h.hasOwnProperty("$"+a)},keys:function(){var a=[],b;for(b in this.h)this.h.hasOwnProperty(b)&&a.push(b.substr(1));return t.iter(a)},iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){return this.ref["$"+this.it.next()]}}},__class__:L};var lc=function(){};e["haxe.io.Bytes"]=lc;lc.__name__=!0;var dc=function(){};e["haxe.io.Eof"]=dc;dc.__name__=!0;dc.prototype={toString:function(){return"Eof"},__class__:dc};
var $b=function(){};e["haxe.rtti.Meta"]=$b;$b.__name__=!0;$b.getType=function(a){a=a.__meta__;return null==a||null==a.obj?{}:a.obj};var A=function(){};e["js.Boot"]=A;A.__name__=!0;A.getClass=function(a){return a instanceof Array&&null==a.__enum__?Array:a.__class__};A.__string_rec=function(a,b){if(null==a)return"null";if(5<=b.length)return"<...>";var c=typeof a;if("function"==c&&(a.__name__||a.__ename__))c="object";switch(c){case "object":if(a instanceof Array){if(a.__enum__){if(2==a.length)return a[0];
for(var c=a[0]+"(",b=b+"\t",d=2,f=a.length;d<f;)var e=d++,c=2!=e?c+(","+A.__string_rec(a[e],b)):c+A.__string_rec(a[e],b);return c+")"}c=a.length;d="[";b+="\t";for(f=0;f<c;)e=f++,d+=(0<e?",":"")+A.__string_rec(a[e],b);return d+"]"}try{d=a.toString}catch(h){return"???"}if(null!=d&&d!=Object.toString&&(c=a.toString(),"[object Object]"!=c))return c;c=null;d="{\n";b+="\t";f=null!=a.hasOwnProperty;for(c in a)if(!f||a.hasOwnProperty(c))"prototype"==c||"__class__"==c||"__super__"==c||"__interfaces__"==c||
"__properties__"==c||(2!=d.length&&(d+=", \n"),d+=b+c+" : "+A.__string_rec(a[c],b));b=b.substring(1);return d+("\n"+b+"}");case "function":return"<function>";case "string":return a;default:return""+a}};A.__interfLoop=function(a,b){if(null==a)return!1;if(a==b)return!0;var c=a.__interfaces__;if(null!=c)for(var d=0,f=c.length;d<f;){var e=d++,e=c[e];if(e==b||A.__interfLoop(e,b))return!0}return A.__interfLoop(a.__super__,b)};A.__instanceof=function(a,b){if(null==b)return!1;switch(b){case pc:return(a|0)===
a;case mc:return"number"==typeof a;case nc:return"boolean"==typeof a;case String:return"string"==typeof a;case Array:return a instanceof Array&&null==a.__enum__;case qc:return!0;default:if(null!=a){if("function"==typeof b&&(a instanceof b||A.__interfLoop(A.getClass(a),b)))return!0}else return!1;return b==rc&&null!=a.__name__||b==sc&&null!=a.__ename__?!0:a.__enum__==b}};var Zb=function(){};e["js.html._CanvasElement.CanvasUtil"]=Zb;Zb.__name__=!0;Zb.getContextWebGL=function(a,b){for(var c=0,d=["webgl",
"experimental-webgl"];c<d.length;){var f=d[c];++c;f=a.getContext(f,b);if(null!=f)return f}return null};var yb=function(a,b,c,d){p.call(this);this._ctx=a;this._velX=b;this._velY=c;this._targets=d};e["shmup.Bullet"]=yb;yb.__name__=!0;yb.__super__=p;yb.prototype=m(p.prototype,{get_name:function(){return"Bullet_10"},onUpdate:function(a){var b=this.owner._compMap.Sprite_0,c=b.x;c.set__(c._value+this._velX*a);c=b.y;c.set__(c._value+this._velY*a);if(0>b.x._value||b.x._value>i._platform.getStage().get_width()||
0>b.y._value||b.y._value>i._platform.getStage().get_height())this.owner.dispose();else{a=0;for(c=this._targets.length;a<c;){var d=this._targets[a],f=d._compMap.Sprite_0,d=d._compMap.Plane_11;if(null!=f&&null!=d){var e=f.x._value-b.x._value,f=f.y._value-b.y._value;if(e*e+f*f<d.radius*d.radius){this.owner.dispose();d.damage(1)&&this._targets.splice(a,1);break}}++a}}},__class__:yb});var ec=function(){};e["shmup.HomeScene"]=ec;ec.__name__=!0;ec.create=function(a){var b=new l,c=new ba(2105376,i._platform.getStage().get_width(),
i._platform.getStage().get_height());b.addChild((new l).add(c));c=new D(a.pack.getTexture("buttons/PlayBig"));c.centerAnchor().setXY(i._platform.getStage().get_width()/2,i._platform.getStage().get_height()/2);c.scaleX.animate(0.5,1,0.5,P.backOut);c.scaleY.animate(0.5,1,0.5,P.backOut);c.get_pointerDown().connect(function(){a.pack.getSound("sounds/Coin").play();a.enterPlayingScene()});b.addChild((new l).add(c));return b};var V=function(a){p.call(this);this._ctx=a;this._enemies=[];this.score=new C(0)};
e["shmup.LevelModel"]=V;V.__name__=!0;V.__super__=p;V.prototype=m(p.prototype,{get_name:function(){return"LevelModel_4"},onAdded:function(){var a=this;this._worldLayer=new l;this.owner.addChild(this._worldLayer);var b=new ea(this._ctx.pack.getTexture("Sky"),i._platform.getStage().get_width(),i._platform.getStage().get_height()+32);this._worldLayer.addChild((new l).add(b));this._worldLayer.addChild(this._cloudLayer=new l);b=new ea(this._ctx.pack.getTexture("Houses"),i._platform.getStage().get_width(),
i._platform.getStage().get_height()+32);this._worldLayer.addChild((new l).add(b));b=new l;this._worldLayer.addChild(this._planeLayer=new l);this._worldLayer.addChild(this._bulletLayer=new l);this._worldLayer.addChild(this._explosionLayer=new l);this._worldLayer.addChild(b=new l);var c=new la(this._ctx,"kid",5,3);c.destroyed.connect(function(){var b=a.player._compMap.Sprite_0;a.explode(b.x._value,b.y._value);b=new Va(0.5);a._worldLayer.add(b);var c=new ja;c.run(new ka([new tb(b.scale,0,1.5),new ia(function(){a._ctx.showPrompt(a._ctx.messages.get("game_over",
[a.score._value]),["Replay",function(){a._ctx.enterPlayingScene(!1)},"Home",function(){a._ctx.director.popScene();a._ctx.enterHomeScene()},"Tweet",function(){i._platform.getWeb().openBrowser("https://twitter.com/share?text="+a._ctx.messages.get("tweet",[a.score._value]))}])})]));a.owner.add(c)});this.player=(new l).add(c);this.player.addChild(c.getWeapon());this._planeLayer.addChild(this.player);this._friendlies=[this.player];var c=this._ctx.pack.getTexture("guns/glock"),d=new D(c);d.get_pointerIn().connect(ma(this,
this.getGlock));c=this._ctx.pack.getTexture("guns/AK");c=new D(c);c.get_pointerIn().connect(ma(this,this.getAK));d=(new l).add(d);b.addChild(d);d=(new l).add(c);c=c.x;c.set__(c._value+300);b.addChild(d);this.playerScript=new ja;this.runPlayerScript();this.player.add(this.playerScript);this.player._compMap.Sprite_0.setXY(i._platform.getStage().get_width()/2,0.8*i._platform.getStage().get_height());b=new ja;this._worldLayer.add(b);b.run(new Ja(new ka([new va(0.5),new ia(function(){var b=(new l).add(new la(a._ctx,
"aircraft_1c",30,2)),c=0;if(0.3>Math.random()){var d=20*Math.random()+75;b.add(new Oa(a._ctx,-d,0)).add(new la(a._ctx,"cart hobo",50,1))}else d=100*Math.random()+150,b.add(new Oa(a._ctx,-d,0)).add(new la(a._ctx,"hobo",30,1));b._compMap.Sprite_0.setXY(i._platform.getStage().get_width(),150*Math.random()+300);var c=10,e=b._compMap.Sprite_0;b._compMap.Plane_11.destroyed.connect(function(){a.explode(e.x._value,e.y._value);var b=a.score;b.set__(b._value+c)});a._planeLayer.addChild(b);a._enemies.push(b)})])))},
runPlayerScript:function(){var a=this;this.playerScript.stopAll();this.playerScript.run(new Ja(new ka([new va(V.BULLET_FREQ),new ia(function(){var b=a.player._compMap.Sprite_0;a.shoot(b.x._value,b.y._value,1.5*V.BULLET_SPEED,0,a._enemies)})])))},getGlock:function(){this.player._compMap.Plane_11.setWeapon("glock");V.BULLET_FREQ=0.3;this.runPlayerScript();this._ctx.pack.getSound("sounds/Coin").play()},getAK:function(){this.player._compMap.Plane_11.setWeapon("AK");V.BULLET_FREQ=0.15;this.runPlayerScript();
this._ctx.pack.getSound("sounds/Coin").play()},shoot:function(a,b,c,d,f){f=new yb(this._ctx,c,d,f);a=(new D(this._ctx.pack.getTexture("Bullet"))).setXY(a,b).centerAnchor();a.rotation.set__(I.toDegrees(Math.atan2(d,c))+90);this._bulletLayer.addChild((new l).add(f).add(a))},explode:function(a,b){var c=this._ctx.lib.createSprite("explosion",!0);c.get_looped().connect(function(){c.owner.dispose()});c.setXY(a,b);this._explosionLayer.addChild((new l).add(c));this._ctx.pack.getSound("sounds/Explode").play()},
onUpdate:function(a){var b=i._platform.getPointer().get_x(),c=i._platform.getPointer().get_y();i._platform.getTouch().get_supported()&&(c-=80);var d=this.player._compMap.Sprite_0;if(null!=d){var f=b-d.x._value,e=c-d.y._value,h=Math.sqrt(f*f+e*e),a=1E3*a;a<h?(b=d.x,b.set__(b._value+a*f/h),d=d.y,d.set__(d._value+a*e/h)):(d.x.set__(b),d.y.set__(c))}for(e=0;e<this._enemies.length;)h=this._enemies[e],d=h._compMap.Sprite_0,f=h._compMap.Plane_11.radius,d.x._value<-f||d.x._value>i._platform.getStage().get_width()+
f||d.y._value<-f||d.y._value>i._platform.getStage().get_height()+f?(this._enemies.splice(e,1),h.dispose()):++e},__class__:V});var fc=function(){};e["shmup.Main"]=fc;fc.__name__=!0;fc.main=function(){i.init();var a=new rb;i.root.add(a);var b=y.fromAssets("bootstrap");i._platform.loadAssetPack(b).get(function(b){i.loadAssetPack(y.fromAssetsLocalized("locale")).get(function(d){var f=i.loadAssetPack(y.fromAssets("main"));f.get(function(f){(new Wb(f,d,a)).enterHomeScene(!1);b.dispose()});f=gc.create(b,
f);a.unwindToScene(f)})})};var la=function(a,b,c,d){p.call(this);this._ctx=a;this._name=b;this.radius=c;this.health=d;this.currentGun="glock";this.gun=new l;this.destroyed=new X};e["shmup.Plane"]=la;la.__name__=!0;la.__super__=p;la.prototype=m(p.prototype,{get_name:function(){return"Plane_11"},onAdded:function(){var a=this._ctx.pack.getTexture("planes/"+this._name),b=F.instance(this.owner._compMap.Sprite_0,D);null==b&&this.owner.add(b=new D(a));this.setWeapon(this.currentGun);b.texture=a;b.setScale(0.5);
b.centerAnchor()},setWeapon:function(a){a=this._ctx.pack.getTexture("guns/"+a);null!=this.gunSprite&&this.gun.remove(this.gunSprite);this.gunSprite=new D(a);this.gun.add(this.gunSprite);a=this.gunSprite.y;a.set__(a._value-45);a=this.gunSprite.x;a.set__(a._value+20)},getWeapon:function(){return this.gun},damage:function(a){if(a>=this.health)return this.health=0,this.destroyed.emit(),this.owner.dispose(),!0;var b=this._ctx.pack.getTexture("planes/"+this._name+"_hit"),c=F.instance(this.owner._compMap.Sprite_0,
D),d=c.texture;d!=b&&(c.texture=b,b=this.owner._compMap.Script_9,null==b&&this.owner.add(b=new ja),b.run(new ka([new va(0.1),new ia(function(){c.texture=d})])));this._ctx.pack.getSound("sounds/Hurt").play();this.health-=a;return!1},__class__:la});var hc=function(){};e["shmup.PlayingScene"]=hc;hc.__name__=!0;hc.create=function(a){var b=new l,c=new V(a);a.level=c;b.add(c);var d=new Aa(a.darkFont);d.setXY(5,5);c.score.watch(function(a){d.set_text(""+a)});b.addChild((new l).add(d));c=new D(a.pack.getTexture("buttons/Pause"));
c.setXY(i._platform.getStage().get_width()-c.texture.get_width()-5,5);c.get_pointerDown().connect(function(){a.showPrompt(a.messages.get("paused"),["Play",function(){a.director.unwindToScene(b)},"Home",function(){a.director.unwindToScene(b);a.enterHomeScene()}])});b.addChild((new l).add(c));return b};var gc=function(){};e["shmup.PreloaderScene"]=gc;gc.__name__=!0;gc.create=function(a,b){var c=new l,d=new ba(2105376,i._platform.getStage().get_width(),i._platform.getStage().get_height());c.addChild((new l).add(d));
var d=new D(a.getTexture("progress/Left")),f=new D(a.getTexture("progress/Right")),e=i._platform.getStage().get_width()-d.texture.get_width()-f.texture.get_width()-40,h=i._platform.getStage().get_height()/2-d.texture.get_height();d.setXY(20,h);c.addChild((new l).add(d));var j=new ea(a.getTexture("progress/Background"),e);j.setXY(d.x._value+d.texture.get_width(),h);c.addChild((new l).add(j));var k=new ea(a.getTexture("progress/Fill"));k.setXY(j.x._value,h);b.progressChanged.connect(function(){k.width.set__(b._progress/
b._total*e)});c.addChild((new l).add(k));f.setXY(k.x._value+e,h);c.addChild((new l).add(f));return c};var ic=function(){};e["shmup.PromptScene"]=ic;ic.__name__=!0;ic.create=function(a,b,c){var d=new l;d.add(new sb(!1));var f=new ba(0,i._platform.getStage().get_width(),i._platform.getStage().get_height());f.alpha.animate(0,0.5,0.5);d.addChild((new l).add(f));b=new Aa(a.lightFont,b);b.setWrapWidth(i._platform.getStage().get_width()).setAlign(H.Center);b.x.animate(-i._platform.getStage().get_width(),
0,0.5,P.backOut);b.y.set__(i._platform.getStage().get_height()/2-150);f=new ba(0,i._platform.getStage().get_width(),b.getNaturalHeight()+5);f.alpha.animate(0,0.5,0.5);f.y.set__(b.y._value);d.addChild((new l).add(f));d.addChild((new l).add(b));for(var f=new l,e=0,h=0;h<c.length;){var k=c[h++],m=[c[h++]],k=new D(a.pack.getTexture("buttons/"+k));k.setXY(e,0);k.get_pointerDown().connect(function(b){return function(){a.pack.getSound("sounds/Coin").play();b[0]()}}(m));e+=k.getNaturalWidth()+20;f.addChild((new l).add(k))}c=
j.getBounds(f);e=new j;e.x.animate(i._platform.getStage().get_width(),i._platform.getStage().get_width()/2-c.width/2,0.5,P.backOut);e.y.set__(b.y._value+b.getNaturalHeight()+50);d.addChild(f.add(e));return d};var Wb=function(a,b,c){this.pack=a;this.director=c;this.messages=Na.parse(b.getFile("messages.ini").toString());this.lightFont=new ca(this.pack,"fonts/Light");this.darkFont=new ca(this.pack,"fonts/Dark");this.lib=Ka.fromFlipbooks([(new Sb("explosion",this.pack.getTexture("Explosion").split(13))).setDuration(0.5).setAnchor(20,
20)])};e["shmup.ShmupContext"]=Wb;Wb.__name__=!0;Wb.prototype={enterHomeScene:function(a){null==a&&(a=!0);this.director.unwindToScene(ec.create(this),a?new Ia(0.5,P.quadOut):null)},enterPlayingScene:function(a){null==a&&(a=!0);this.director.unwindToScene(hc.create(this),a?new Ia(0.5,P.quadOut):null)},showPrompt:function(a,b){this.director.pushScene(ic.create(this,a,b))},__class__:Wb};var Oa=function(a,b,c){p.call(this);this._ctx=a;this._velX=b;this._velY=c};e["shmup.ai.MoveStraight"]=Oa;Oa.__name__=
!0;Oa.__super__=p;Oa.prototype=m(p.prototype,{get_name:function(){return"MoveStraight_7"},onAdded:function(){},onUpdate:function(a){var b=this.owner._compMap.Sprite_0,c=b.x;c.set__(c._value+this._velX*a);b=b.y;b.set__(b._value+this._velY*a)},__class__:Oa});var oc=0;Math.NaN=Number.NaN;Math.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY;Math.POSITIVE_INFINITY=Number.POSITIVE_INFINITY;e.Math=Math;Math.isFinite=function(a){return isFinite(a)};Math.isNaN=function(a){return isNaN(a)};String.prototype.__class__=
e.String=String;String.__name__=!0;e.Array=Array;Array.__name__=!0;Date.prototype.__class__=e.Date=Date;Date.__name__=["Date"];var pc=e.Int={__name__:["Int"]},qc=e.Dynamic={__name__:["Dynamic"]},mc=e.Float=Number;mc.__name__=["Float"];var nc=e.Bool=Boolean;nc.__ename__=["Bool"];var rc=e.Class={__name__:["Class"]},sc={};Y.instance=new Y;w.DISPATCHING_SENTINEL=new ra(null,null);i.root=new l;i.uncaughtError=new v;i.hidden=new C(!1);i.volume=new s(1);i._platform=Y.instance;i._calledInit=!1;y.__meta__=
{obj:{assets:[{locale_pt:[{bytes:111,md5:"d39630c6803a1cdb76567f8e14aae713",name:"messages.ini"}],locale_es:[{bytes:114,md5:"a03300e7812ca9095c98d4555cf12b0f",name:"messages.ini"}],bootstrap:[{bytes:3822,md5:"7942f02ae6cb4d11a04655ba03ea5972",name:"plane.png"},{bytes:236,md5:"34b7888d4dc22ec17c6d25c41e1a57b7",name:"progress/Background.png"},{bytes:233,md5:"d613aae715f9d2c1b55956b808f90f86",name:"progress/Fill.png"},{bytes:1802,md5:"44b1bf482e12d3cc29d5e975c2a81268",name:"progress/Left.png"},{bytes:1812,
md5:"86b2bcf01a1c11269cd915976564f623",name:"progress/Right.png"}],locale:[{bytes:109,md5:"552b442ae926b72e3a8471963702b36c",name:"messages.ini"}],main:[{bytes:366,md5:"ee432f4e4b5d088af85ea30d6ad90f3c",name:"Bullet.png"},{bytes:12613,md5:"b33d8fd91c6250e6551b533eb8cae299",name:"buttons/Home.png"},{bytes:3224,md5:"ade05912106ca06514d381385146dec1",name:"buttons/Pause.png"},{bytes:11533,md5:"c94b374f232084440c6ec2109bbd627f",name:"buttons/Play.png"},{bytes:87218,md5:"f26f9ba2a6e523dbc530bef9e350f2d7",
name:"buttons/PlayBig.png"},{bytes:13530,md5:"526b5cfaeb0b8a7f1fc1f84a9384e4f6",name:"buttons/Replay.png"},{bytes:12515,md5:"e58578e54d679e75f98c9ea93de71b30",name:"buttons/Tweet.png"},{bytes:22640,md5:"bf40f88eb86c95e085a96b9aee9093df",name:"buttons/Volume.png"},{bytes:30738,md5:"de94be294d56927673fa02273bb0151d",name:"Cloud.png"},{bytes:5085,md5:"1395c0c8e493ba87bcf2e6ac96d86552",name:"Explosion.png"},{bytes:11645,md5:"60c1cc140b88a7939b09f26d5be11b0d",name:"fonts/Dark.fnt"},{bytes:5456,md5:"dfc26da7af9a8e360e1dd28d40334114",
name:"fonts/Dark.png"},{bytes:11646,md5:"f7bc5b83f0d70a42ba589a475d45c92e",name:"fonts/Light.fnt"},{bytes:7009,md5:"68caffab9c0221872d81ab200d548414",name:"fonts/Light.png"},{bytes:24274,md5:"f5c70f1ad8b519412c7ef95d86a18ae8",name:"guns/AK.png"},{bytes:12936,md5:"67e70eb7a07d227422065f66473cee98",name:"guns/genade.png"},{bytes:15233,md5:"f7b9bf260716845c4ebe58177afacfd1",name:"guns/glock.png"},{bytes:8254788,md5:"1df3ab6cac18b2429f4f4f18b1f867c3",name:"guns/inventory guns.psd"},{bytes:30344,md5:"e02f9a65b7a231c7ecf83b7f04cc507c",
name:"guns/launcher.png"},{bytes:28064,md5:"341a8c4b42616e990c66f32cc2a64917",name:"guns/M4.png"},{bytes:16722,md5:"6445024fcb1fa144030dfa6c717e762b",name:"guns/revolver.png"},{bytes:18216,md5:"f96822597e6c6d48e76871d6bfe12bfe",name:"guns/shotgun.png"},{bytes:839297,md5:"981234da79d438940f1ab725f14e5cf2",name:"Houses.png"},{bytes:613953,md5:"b27d387be625148947f8d97bdf2febe1",name:"Mountains.png"},{bytes:105563,md5:"eaa7c782d827c81e78e3c9ce319cbf04",name:"planes/aircraft_1c.png"},{bytes:6352,md5:"f3fe14da20d9b8d6e8179159f42a7d3a",
name:"planes/aircraft_1c_hit.png"},{bytes:4335,md5:"dcf18f268d6436758a1fa6f6ee78043c",name:"planes/aircraft_1e.png"},{bytes:5996,md5:"b68b10aea42b4a7c65904011eefb63a0",name:"planes/aircraft_1e_hit.png"},{bytes:5614,md5:"1b81cf47bc97dfb6d4d2e4cad61edeb6",name:"planes/aircraft_2c.png"},{bytes:6940,md5:"2b6450339988b0f792539f09e94f022b",name:"planes/aircraft_2c_hit.png"},{bytes:7413,md5:"35ce23164b1aa30608256e15b23d19d6",name:"planes/aircraft_3.png"},{bytes:8039,md5:"05a3090cbe90987795a2fb9354d34c2a",
name:"planes/aircraft_3_hit.png"},{bytes:66035,md5:"c0d7daca18d6b5f22eb36ab2143cc328",name:"planes/carhobo.png"},{bytes:105563,md5:"eaa7c782d827c81e78e3c9ce319cbf04",name:"planes/cart hobo.png"},{bytes:66035,md5:"c0d7daca18d6b5f22eb36ab2143cc328",name:"planes/hobo.png"},{bytes:11064,md5:"a2e087cc5497de2b1f33494d21c0c8f3",name:"planes/kid.png"},{bytes:424928,md5:"d7c7888e7bf0fac8baa479403376b6f3",name:"Sky.png"},{bytes:4596,md5:"49e254572662a3079a51db00e7ef4078",name:"sounds/Coin.mp3"},{bytes:6677,
md5:"12729883bc3721ca83bf12ba63eb577d",name:"sounds/Coin.ogg"},{bytes:5223,md5:"45390ef68058f7b85aaa1b55a80563ac",name:"sounds/Explode.mp3"},{bytes:8614,md5:"77f1e0ef33be39e53409a18deb6c6a10",name:"sounds/Explode.ogg"},{bytes:1043,md5:"8f76f25e9acc72f2cef5e5a28e9651de",name:"sounds/Hurt.mp3"},{bytes:4184,md5:"6a3ededdce743a97cf9cfdeafbf59625",name:"sounds/Hurt.ogg"},{bytes:334,md5:"232dea903d13d1f3b82d0d31ab58f4d1",name:"Water.png"}]}]}};y._supportsCrossOrigin=function(){var a;a=0<=window.navigator.userAgent.indexOf("Linux; U; Android")?
!1:null!=(new XMLHttpRequest).withCredentials;a||null;return a}();j._scratchPoint=new Ya;ca.NEWLINE=new Za(10);J._sharedEvent=new Fb;B._sharedEvent=new Gb;qa.CANVAS_TEXTURES=(new K("(iPhone|iPod|iPad)","")).match(window.navigator.userAgent);q._mediaRefCount=0;q._detectBlobSupport=!0;k.VENDOR_PREFIXES=["webkit","moz","ms","o","khtml"];k.SHOULD_HIDE_MOBILE_BROWSER=window.top==window&&(new K("Mobile(/.*)? Safari","")).match(window.navigator.userAgent);r._detectSupport=!0;S._scratchMatrix=new Q;V.BULLET_SPEED=
500;V.BULLET_FREQ=0.3;fc.main()})();
